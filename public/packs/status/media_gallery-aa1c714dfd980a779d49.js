webpackJsonp([26],{158:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"default",function(){return G});var a,n,s,l,o,r=i(2),p=i.n(r),d=i(1),u=i.n(d),c=i(3),h=i.n(c),g=i(4),v=i.n(g),m=i(0),f=i.n(m),y=i(7),b=i.n(y),_=i(8),P=(i.n(_),i(18)),k=i(5),x=i(33),C=i(10),w=i.n(C),M=Object(k.f)({toggle_visible:{id:"media_gallery.toggle_visible",defaultMessage:"Toggle visibility"}}),N=(n=a=function(e){function t(){var i,a,n;u()(this,t);for(var s=arguments.length,l=Array(s),o=0;o<s;o++)l[o]=arguments[o];return i=a=h()(this,e.call.apply(e,[this].concat(l))),a.handleMouseEnter=function(e){a.hoverToPlay()&&e.target.play()},a.handleMouseLeave=function(e){a.hoverToPlay()&&(e.target.pause(),e.target.currentTime=0)},a.handleClick=function(e){var t=a.props,i=t.index,n=t.onClick;a.context.router&&0===e.button&&(e.preventDefault(),n(i)),e.stopPropagation()},n=i,h()(a,n)}return v()(t,e),t.prototype.hoverToPlay=function(){var e=this.props,t=e.attachment;return!e.autoPlayGif&&"gifv"===t.get("type")},t.prototype.render=function(){var e=this.props,t=e.attachment,i=e.index,a=e.size,n=e.standalone,s=50,l=100,o="auto",r="auto",d="auto",u="auto";1===a&&(s=100),(4===a||3===a&&i>0)&&(l=50),2===a?0===i?u="2px":r="2px":3===a?(0===i?u="2px":i>0&&(r="2px"),1===i?d="2px":i>1&&(o="2px")):4===a&&(0!==i&&2!==i||(u="2px"),1!==i&&3!==i||(r="2px"),i<2?d="2px":o="2px");var c="";if("image"===t.get("type")){var h=t.get("preview_url"),g=t.getIn(["meta","small","width"]),v=t.get("url"),m=t.getIn(["meta","original","width"]),f="number"==typeof m&&"number"==typeof g,y=f?v+" "+m+"w, "+h+" "+g+"w":null,b=f?"(min-width: 1025px) "+s/100*320+"px, "+s+"vw":null;c=p()("a",{className:"media-gallery__item-thumbnail",href:t.get("remote_url")||v,onClick:this.handleClick,target:"_blank"},void 0,p()("img",{src:h,srcSet:y,sizes:b,alt:t.get("description"),title:t.get("description")}))}else if("gifv"===t.get("type")){var _=!Object(x.a)()&&this.props.autoPlayGif;c=p()("div",{className:w()("media-gallery__gifv",{autoplay:_})},void 0,p()("video",{className:"media-gallery__item-gifv-thumbnail","aria-label":t.get("description"),role:"application",src:t.get("url"),onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,autoPlay:_,loop:!0,muted:!0}),p()("span",{className:"media-gallery__gifv__label"},void 0,"GIF"))}return p()("div",{className:w()("media-gallery__item",{standalone:n}),style:{left:r,top:o,right:u,bottom:d,width:s+"%",height:l+"%"}},t.get("id"),c)},t}(f.a.PureComponent),a.contextTypes={router:b.a.object},a.defaultProps={autoPlayGif:!1,standalone:!1,index:0,size:1},n),G=Object(k.g)((o=l=function(e){function t(){var i,a,n;u()(this,t);for(var s=arguments.length,l=Array(s),o=0;o<s;o++)l[o]=arguments[o];return i=a=h()(this,e.call.apply(e,[this].concat(l))),a.state={visible:!a.props.sensitive},a.handleOpen=function(){a.setState({visible:!a.state.visible})},a.handleClick=function(e){a.props.onOpenMedia(a.props.media,e)},a.handleRef=function(e){e&&a.isStandaloneEligible()&&a.setState({width:e.offsetWidth})},n=i,h()(a,n)}return v()(t,e),t.prototype.componentWillReceiveProps=function(e){Object(_.is)(e.media,this.props.media)||this.setState({visible:!e.sensitive})},t.prototype.isStandaloneEligible=function(){var e=this.props,t=e.media;return e.standalone&&1===t.size&&t.getIn([0,"meta","small","aspect"])},t.prototype.render=function(){var e=this,t=this.props,i=t.media,a=t.intl,n=t.sensitive,s=t.height,l=this.state,o=l.width,r=l.visible,d=void 0,u={};if(this.isStandaloneEligible()?u.height=!r&&o?o/this.props.media.getIn([0,"meta","small","aspect"]):"":u.height=s,r){var c=i.take(4).size;d=this.isStandaloneEligible()?p()(N,{standalone:!0,onClick:this.handleClick,attachment:i.get(0),autoPlayGif:this.props.autoPlayGif}):i.take(4).map(function(t,i){return p()(N,{onClick:e.handleClick,attachment:t,autoPlayGif:e.props.autoPlayGif,index:i,size:c},t.get("id"))})}else{var h=void 0;h=n?p()(k.b,{id:"status.sensitive_warning",defaultMessage:"Sensitive content"}):p()(k.b,{id:"status.media_hidden",defaultMessage:"Media hidden"}),d=f.a.createElement("button",{className:"media-spoiler",onClick:this.handleOpen,style:u,ref:this.handleRef},p()("span",{className:"media-spoiler__warning"},void 0,h),p()("span",{className:"media-spoiler__trigger"},void 0,p()(k.b,{id:"status.sensitive_toggle",defaultMessage:"Click to view"})))}return p()("div",{className:"media-gallery",style:u},void 0,p()("div",{className:w()("spoiler-button",{"spoiler-button--visible":r})},void 0,p()(P.a,{title:a.formatMessage(M.toggle_visible),icon:r?"eye":"eye-slash",overlay:!0,onClick:this.handleOpen})),d)},t}(f.a.PureComponent),l.defaultProps={autoPlayGif:!1,standalone:!1},s=o))||s}});
//# sourceMappingURL=media_gallery-aa1c714dfd980a779d49.js.map