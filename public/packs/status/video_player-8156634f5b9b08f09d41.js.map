{"version":3,"sources":["webpack:///status/video_player-8156634f5b9b08f09d41.js","webpack:///./app/javascript/mastodon/components/video_player.js"],"names":["webpackJsonp","793","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","d","VideoPlayer","_class","_class2","_temp2","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default","__WEBPACK_IMPORTED_MODULE_4_react__","__WEBPACK_IMPORTED_MODULE_4_react___default","__WEBPACK_IMPORTED_MODULE_5_prop_types__","__WEBPACK_IMPORTED_MODULE_5_prop_types___default","__WEBPACK_IMPORTED_MODULE_6__icon_button__","__WEBPACK_IMPORTED_MODULE_7_react_intl__","__WEBPACK_IMPORTED_MODULE_8__is_mobile__","messages","toggle_sound","id","defaultMessage","toggle_visible","expand_video","_React$PureComponent","_temp","_this","_ret","this","_len","arguments","length","args","Array","_key","call","apply","concat","state","visible","props","sensitive","preview","muted","hasAudio","videoError","handleClick","setState","handleVideoClick","e","stopPropagation","node","video","paused","play","pause","handleOpen","handleVisibility","handleExpand","onOpenVideo","media","currentTime","setRef","c","handleLoadedData","document","documentElement","style","audioTracks","mozHasAudio","handleVideoError","prototype","componentDidMount","addEventListener","componentDidUpdate","componentWillUnmount","removeEventListener","render","_props","intl","width","height","autoplay","spoilerButton","className","overlay","title","formatMessage","icon","onClick","expandButton","context","router","muteButton","backgroundImage","get","a","createElement","role","tabIndex","ref","src","autoPlay","loop","marginTop","PureComponent","contextTypes","object","defaultProps"],"mappings":"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","file":"status/video_player-8156634f5b9b08f09d41.js","sourcesContent":["webpackJsonp([26],{\n\n/***/ 793:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return VideoPlayer; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_prop_types__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_prop_types___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_prop_types__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__icon_button__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_intl__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__is_mobile__ = __webpack_require__(41);\n\n\n\n\n\nvar _class, _class2, _temp2;\n\n\n\n\n\n\n\n\nvar messages = Object(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"g\" /* defineMessages */])({\n  toggle_sound: {\n    'id': 'video_player.toggle_sound',\n    'defaultMessage': 'Toggle sound'\n  },\n  toggle_visible: {\n    'id': 'video_player.toggle_visible',\n    'defaultMessage': 'Toggle visibility'\n  },\n  expand_video: {\n    'id': 'video_player.expand',\n    'defaultMessage': 'Expand video'\n  }\n});\n\nvar VideoPlayer = Object(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"h\" /* injectIntl */])(_class = (_temp2 = _class2 = function (_React$PureComponent) {\n  __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default()(VideoPlayer, _React$PureComponent);\n\n  function VideoPlayer() {\n    var _temp, _this, _ret;\n\n    __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this, VideoPlayer);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(this, _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args))), _this), _this.state = {\n      visible: !_this.props.sensitive,\n      preview: true,\n      muted: true,\n      hasAudio: true,\n      videoError: false\n    }, _this.handleClick = function () {\n      _this.setState({ muted: !_this.state.muted });\n    }, _this.handleVideoClick = function (e) {\n      e.stopPropagation();\n\n      var node = _this.video;\n\n      if (node.paused) {\n        node.play();\n      } else {\n        node.pause();\n      }\n    }, _this.handleOpen = function () {\n      _this.setState({ preview: !_this.state.preview });\n    }, _this.handleVisibility = function () {\n      _this.setState({\n        visible: !_this.state.visible,\n        preview: true\n      });\n    }, _this.handleExpand = function () {\n      _this.video.pause();\n      _this.props.onOpenVideo(_this.props.media, _this.video.currentTime);\n    }, _this.setRef = function (c) {\n      _this.video = c;\n    }, _this.handleLoadedData = function () {\n      if ('WebkitAppearance' in document.documentElement.style && _this.video.audioTracks.length === 0 || _this.video.mozHasAudio === false) {\n        _this.setState({ hasAudio: false });\n      }\n    }, _this.handleVideoError = function () {\n      _this.setState({ videoError: true });\n    }, _temp), __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(_this, _ret);\n  }\n\n  VideoPlayer.prototype.componentDidMount = function componentDidMount() {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.addEventListener('loadeddata', this.handleLoadedData);\n    this.video.addEventListener('error', this.handleVideoError);\n  };\n\n  VideoPlayer.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.addEventListener('loadeddata', this.handleLoadedData);\n    this.video.addEventListener('error', this.handleVideoError);\n  };\n\n  VideoPlayer.prototype.componentWillUnmount = function componentWillUnmount() {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.removeEventListener('loadeddata', this.handleLoadedData);\n    this.video.removeEventListener('error', this.handleVideoError);\n  };\n\n  VideoPlayer.prototype.render = function render() {\n    var _props = this.props,\n        media = _props.media,\n        intl = _props.intl,\n        width = _props.width,\n        height = _props.height,\n        sensitive = _props.sensitive,\n        autoplay = _props.autoplay;\n\n\n    var spoilerButton = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n      className: 'status__video-player-spoiler ' + (this.state.visible ? 'status__video-player-spoiler--visible' : '')\n    }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6__icon_button__[\"a\" /* default */], {\n      overlay: true,\n      title: intl.formatMessage(messages.toggle_visible),\n      icon: this.state.visible ? 'eye' : 'eye-slash',\n      onClick: this.handleVisibility\n    }));\n\n    var expandButton = '';\n\n    if (this.context.router) {\n      expandButton = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'status__video-player-expand'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6__icon_button__[\"a\" /* default */], {\n        overlay: true,\n        title: intl.formatMessage(messages.expand_video),\n        icon: 'expand',\n        onClick: this.handleExpand\n      }));\n    }\n\n    var muteButton = '';\n\n    if (this.state.hasAudio) {\n      muteButton = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'status__video-player-mute'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_6__icon_button__[\"a\" /* default */], {\n        overlay: true,\n        title: intl.formatMessage(messages.toggle_sound),\n        icon: this.state.muted ? 'volume-off' : 'volume-up',\n        onClick: this.handleClick\n      }));\n    }\n\n    if (!this.state.visible) {\n      if (sensitive) {\n        return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n          style: { width: width + 'px', height: height + 'px', marginTop: '8px' },\n          className: 'media-spoiler',\n          onClick: this.handleVisibility\n        }, void 0, spoilerButton, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n          className: 'media-spoiler__warning'\n        }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], {\n          id: 'status.sensitive_warning',\n          defaultMessage: 'Sensitive content'\n        })), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n          className: 'media-spoiler__trigger'\n        }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], {\n          id: 'status.sensitive_toggle',\n          defaultMessage: 'Click to view'\n        })));\n      } else {\n        return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n          style: { width: width + 'px', height: height + 'px', marginTop: '8px' },\n          className: 'media-spoiler',\n          onClick: this.handleVisibility\n        }, void 0, spoilerButton, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n          className: 'media-spoiler__warning'\n        }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], {\n          id: 'status.media_hidden',\n          defaultMessage: 'Media hidden'\n        })), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n          className: 'media-spoiler__trigger'\n        }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], {\n          id: 'status.sensitive_toggle',\n          defaultMessage: 'Click to view'\n        })));\n      }\n    }\n\n    if (this.state.preview && !autoplay) {\n      return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n        className: 'media-spoiler-video',\n        style: { width: width + 'px', height: height + 'px', backgroundImage: 'url(' + media.get('preview_url') + ')' },\n        onClick: this.handleOpen\n      }, void 0, spoilerButton, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'media-spoiler-video-play-icon'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('i', {\n        className: 'fa fa-play'\n      })));\n    }\n\n    if (this.state.videoError) {\n      return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        style: { width: width + 'px', height: height + 'px' },\n        className: 'video-error-cover'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n        className: 'media-spoiler__warning'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], {\n        id: 'video_player.video_error',\n        defaultMessage: 'Video could not be played'\n      })));\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n      className: 'status__video-player',\n      style: { width: width + 'px', height: height + 'px' }\n    }, void 0, spoilerButton, muteButton, expandButton, __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement('video', {\n      className: 'status__video-player-video',\n      role: 'button',\n      tabIndex: '0',\n      ref: this.setRef,\n      src: media.get('url'),\n      autoPlay: !Object(__WEBPACK_IMPORTED_MODULE_8__is_mobile__[\"a\" /* isIOS */])(),\n      loop: true,\n      muted: this.state.muted,\n      onClick: this.handleVideoClick\n    }));\n  };\n\n  return VideoPlayer;\n}(__WEBPACK_IMPORTED_MODULE_4_react___default.a.PureComponent), _class2.contextTypes = {\n  router: __WEBPACK_IMPORTED_MODULE_5_prop_types___default.a.object\n}, _class2.defaultProps = {\n  width: 239,\n  height: 110\n}, _temp2)) || _class;\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// status/video_player-8156634f5b9b08f09d41.js","import React from 'react';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport PropTypes from 'prop-types';\nimport IconButton from './icon_button';\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\nimport { isIOS } from '../is_mobile';\n\nconst messages = defineMessages({\n  toggle_sound: { id: 'video_player.toggle_sound', defaultMessage: 'Toggle sound' },\n  toggle_visible: { id: 'video_player.toggle_visible', defaultMessage: 'Toggle visibility' },\n  expand_video: { id: 'video_player.expand', defaultMessage: 'Expand video' },\n});\n\n@injectIntl\nexport default class VideoPlayer extends React.PureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    media: ImmutablePropTypes.map.isRequired,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    sensitive: PropTypes.bool,\n    intl: PropTypes.object.isRequired,\n    autoplay: PropTypes.bool,\n    onOpenVideo: PropTypes.func.isRequired,\n  };\n\n  static defaultProps = {\n    width: 239,\n    height: 110,\n  };\n\n  state = {\n    visible: !this.props.sensitive,\n    preview: true,\n    muted: true,\n    hasAudio: true,\n    videoError: false,\n  };\n\n  handleClick = () => {\n    this.setState({ muted: !this.state.muted });\n  }\n\n  handleVideoClick = (e) => {\n    e.stopPropagation();\n\n    const node = this.video;\n\n    if (node.paused) {\n      node.play();\n    } else {\n      node.pause();\n    }\n  }\n\n  handleOpen = () => {\n    this.setState({ preview: !this.state.preview });\n  }\n\n  handleVisibility = () => {\n    this.setState({\n      visible: !this.state.visible,\n      preview: true,\n    });\n  }\n\n  handleExpand = () => {\n    this.video.pause();\n    this.props.onOpenVideo(this.props.media, this.video.currentTime);\n  }\n\n  setRef = (c) => {\n    this.video = c;\n  }\n\n  handleLoadedData = () => {\n    if (('WebkitAppearance' in document.documentElement.style && this.video.audioTracks.length === 0) || this.video.mozHasAudio === false) {\n      this.setState({ hasAudio: false });\n    }\n  }\n\n  handleVideoError = () => {\n    this.setState({ videoError: true });\n  }\n\n  componentDidMount () {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.addEventListener('loadeddata', this.handleLoadedData);\n    this.video.addEventListener('error', this.handleVideoError);\n  }\n\n  componentDidUpdate () {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.addEventListener('loadeddata', this.handleLoadedData);\n    this.video.addEventListener('error', this.handleVideoError);\n  }\n\n  componentWillUnmount () {\n    if (!this.video) {\n      return;\n    }\n\n    this.video.removeEventListener('loadeddata', this.handleLoadedData);\n    this.video.removeEventListener('error', this.handleVideoError);\n  }\n\n  render () {\n    const { media, intl, width, height, sensitive, autoplay } = this.props;\n\n    let spoilerButton = (\n      <div className={`status__video-player-spoiler ${this.state.visible ? 'status__video-player-spoiler--visible' : ''}`}>\n        <IconButton overlay title={intl.formatMessage(messages.toggle_visible)} icon={this.state.visible ? 'eye' : 'eye-slash'} onClick={this.handleVisibility} />\n      </div>\n    );\n\n    let expandButton = '';\n\n    if (this.context.router) {\n      expandButton = (\n        <div className='status__video-player-expand'>\n          <IconButton overlay title={intl.formatMessage(messages.expand_video)} icon='expand' onClick={this.handleExpand} />\n        </div>\n      );\n    }\n\n    let muteButton = '';\n\n    if (this.state.hasAudio) {\n      muteButton = (\n        <div className='status__video-player-mute'>\n          <IconButton overlay title={intl.formatMessage(messages.toggle_sound)} icon={this.state.muted ? 'volume-off' : 'volume-up'} onClick={this.handleClick} />\n        </div>\n      );\n    }\n\n    if (!this.state.visible) {\n      if (sensitive) {\n        return (\n          <button style={{ width: `${width}px`, height: `${height}px`, marginTop: '8px' }} className='media-spoiler' onClick={this.handleVisibility}>\n            {spoilerButton}\n            <span className='media-spoiler__warning'><FormattedMessage id='status.sensitive_warning' defaultMessage='Sensitive content' /></span>\n            <span className='media-spoiler__trigger'><FormattedMessage id='status.sensitive_toggle' defaultMessage='Click to view' /></span>\n          </button>\n        );\n      } else {\n        return (\n          <button style={{ width: `${width}px`, height: `${height}px`, marginTop: '8px' }} className='media-spoiler' onClick={this.handleVisibility}>\n            {spoilerButton}\n            <span className='media-spoiler__warning'><FormattedMessage id='status.media_hidden' defaultMessage='Media hidden' /></span>\n            <span className='media-spoiler__trigger'><FormattedMessage id='status.sensitive_toggle' defaultMessage='Click to view' /></span>\n          </button>\n        );\n      }\n    }\n\n    if (this.state.preview && !autoplay) {\n      return (\n        <button className='media-spoiler-video' style={{ width: `${width}px`, height: `${height}px`, backgroundImage: `url(${media.get('preview_url')})` }} onClick={this.handleOpen}>\n          {spoilerButton}\n          <div className='media-spoiler-video-play-icon'><i className='fa fa-play' /></div>\n        </button>\n      );\n    }\n\n    if (this.state.videoError) {\n      return (\n        <div style={{ width: `${width}px`, height: `${height}px` }} className='video-error-cover' >\n          <span className='media-spoiler__warning'><FormattedMessage id='video_player.video_error' defaultMessage='Video could not be played' /></span>\n        </div>\n      );\n    }\n\n    return (\n      <div className='status__video-player' style={{ width: `${width}px`, height: `${height}px` }}>\n        {spoilerButton}\n        {muteButton}\n        {expandButton}\n\n        <video\n          className='status__video-player-video'\n          role='button'\n          tabIndex='0'\n          ref={this.setRef}\n          src={media.get('url')}\n          autoPlay={!isIOS()}\n          loop\n          muted={this.state.muted}\n          onClick={this.handleVideoClick}\n        />\n      </div>\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/mastodon/components/video_player.js"],"sourceRoot":""}