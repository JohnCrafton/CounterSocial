/**
 * Blur Copyright (c) 2008-2015 by Abine, Inc. All Rights Reserved.
 *
 * This software is the confidential and proprietary information
 * of Abine, Inc. ("Confidential Information"), subject
 * to the Non-Disclosure Agreement and/or License Agreement you entered
 * into with Abine. You shall use such Confidential Information only
 * in accordance with the terms of said Agreement(s). Abine makes
 * no representations or warranties about the suitability of the
 * software. The software is provided with ABSOLUTELY NO WARRANTY
 * and Abine will NOT BE LIABLE for ANY DAMAGES resulting from
 * the use of the software.
 *
 * Contact license@getabine.com with any license-related questions.
 *
 * https://www.abine.com
 * @license
 *
 */
ABINE_DNTME.define("abine/timer",[],function(){var e=1,t={},n=function(n,a){var i=e++,r=Cc["@mozilla.org/timer;1"].createInstance(Ci.nsITimer);return t[i]=r,r.initWithCallback(function(){delete t[i],n()},a,Ci.nsITimer.TYPE_ONE_SHOT),i},a=function(e){try{e in t&&(t[e].cancel(),delete t[e])}catch(e){}},i=function(n,a){var i=e++,r=Cc["@mozilla.org/timer;1"].createInstance(Ci.nsITimer);return t[i]=r,r.initWithCallback(n,a,Ci.nsITimer.TYPE_REPEATING_SLACK),i},r={};return"undefined"!=typeof window&&"function"==typeof window.setTimeout?r.setTimeout=function(){return ABINE_DNTME.log,window.setTimeout.apply(window,arguments)}:r.setTimeout=n,"undefined"!=typeof window&&"function"==typeof window.clearTimeout?r.clearTimeout=function(){window.clearTimeout.apply(window,arguments)}:r.clearTimeout=a,"undefined"!=typeof window&&"function"==typeof window.setInterval?r.setInterval=function(){return window.setInterval.apply(window,arguments)}:r.setInterval=i,"undefined"!=typeof window&&"function"==typeof window.clearInterval?r.clearInterval=function(){window.clearInterval.apply(window,arguments)}:r.clearInterval=a,r}),ABINE_DNTME.define("abine/intl",[],function(){function e(r,s){if(r in i)if(r in a)n=BUNDLE[r],t=r,s();else{var o=document.createElement("script");o.setAttribute("src","locales/"+r+".js"),o.addEventListener("load",function(){a[r]=!0,n=BUNDLE[r],t=r,s()}),o.addEventListener("error",function(){e("en",s)}),document.getElementsByTagName("body")[0].appendChild(o)}else e("en",s)}var t=navigator.language.replace(/\-.*/,"").toLowerCase(),n=null,a={en:1},i={en:1,de:1,fr:1,it:1,nl:1,pl:1,pt:1,zh:1};return{setupLocale:e,getLang:function(){return t},getText:function(e,t){t&&"object"!=typeof t&&(t=[t]);var a=null;if(e=e.replace(/\./g,"_"),n)try{a=n[e]||BUNDLE.en[e],a&&t&&(a=a.replace(/\{([0-9]+)\}/g,function(e,n){return t[parseInt(n)]+""}))}catch(e){}return a&&""!=a||(a="***"+e),a}}});/*!
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
var CryptoJS=CryptoJS||function(e,t){var n={},a=n.lib={},i=a.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),r=a.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=4*e.length},toString:function(e){return(e||o).stringify(this)},concat:function(e){var t=this.words,n=e.words,a=this.sigBytes,i=e.sigBytes;if(this.clamp(),a%4)for(var r=0;r<i;r++){var s=n[r>>>2]>>>24-r%4*8&255;t[a+r>>>2]|=s<<24-(a+r)%4*8}else if(n.length>65535)for(var r=0;r<i;r+=4)t[a+r>>>2]=n[r>>>2];else t.push.apply(t,n);return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],a=0;a<t;a+=4)n.push(4294967296*e.random()|0);return new r.init(n,t)}}),s=n.enc={},o=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],i=0;i<n;i++){var r=t[i>>>2]>>>24-i%4*8&255;a.push((r>>>4).toString(16)),a.push((15&r).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a+=2)n[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new r.init(n,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],i=0;i<n;i++){var r=t[i>>>2]>>>24-i%4*8&255;a.push(String.fromCharCode(r))}return a.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a++)n[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new r.init(n,t)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},c=a.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,a=n.words,i=n.sigBytes,s=this.blockSize,o=4*s,l=i/o;l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0);var d=l*s,c=e.min(4*d,i);if(d){for(var m=0;m<d;m+=s)this._doProcessBlock(a,m);var u=a.splice(0,d);n.sigBytes-=c}return new r.init(u,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=c.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),n.algo={});return n}(Math);/*!
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
!function(){var e=CryptoJS,t=e.lib,n=t.WordArray,a=t.Hasher,i=e.algo,r=[],s=i.SHA1=a.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,a=n[0],i=n[1],s=n[2],o=n[3],l=n[4],d=0;d<80;d++){if(d<16)r[d]=0|e[t+d];else{var c=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=c<<1|c>>>31}var m=(a<<5|a>>>27)+l+r[d];m+=d<20?(i&s|~i&o)+1518500249:d<40?(i^s^o)+1859775393:d<60?(i&s|i&o|s&o)-1894007588:(i^s^o)-899497514,l=o,o=s,s=i<<30|i>>>2,i=a,a=m}n[0]=n[0]+a|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[(a+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(a+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=a._createHelper(s),e.HmacSHA1=a._createHmacHelper(s)}(),/*!
 CryptoJS v3.1.2
 code.google.com/p/crypto-js
 (c) 2009-2013 by Jeff Mott. All rights reserved.
 code.google.com/p/crypto-js/wiki/License
 */
ABINE_DNTME.define("cryptojs",function(){return{SHA1:function(e){return CryptoJS.SHA1(e).toString()}}}),ABINE_DNTME.define("abine/core",["documentcloud/underscore"],function(e){var t={on:function(e,t,n){var a=this._callbacks||(this._callbacks={}),i=a[e]||(a[e]={}),r=i.tail||(i.tail=i.next={});return r.callback=t,r.context=n,i.tail=r.next={},this},off:function(e,t){var n,a,i;if(e){if(n=this._callbacks)if(t){if(a=n[e])for(;(i=a)&&(a=a.next);)if(a.callback===t){i.next=a.next,a.context=a.callback=null;break}}else n[e]={}}else this._callbacks=null;return this},trigger:function(e){var t,n,a,i,r,s=["all",e];if(!(n=this._callbacks))return this;for(;r=s.pop();)if(t=n[r])for(i="all"==r?arguments:Array.prototype.slice.call(arguments,1);t=t.next;)(a=t.callback)&&a.apply(t.context||this,i);return this},once:function(e,t,n){function a(){return i.off(e,a),t.apply(this,arguments)}var i=this;return this.on(e,a,n)},onceAny:function(){function e(){for(var n=0;n<t.length;n++)this.off.apply(this,[t[n][0],e]),this.off.apply(this,t[n])}for(var t=arguments,n=0;n<arguments.length;n++)this.on.apply(this,arguments[n]),this.on.apply(this,[arguments[n][0],e]);return this},hasListeners:function(e){var t,n;if(!(n=this._callbacks))return!1;if(!(t=n[e]))return!1;for(;t=t.next;)if(t.callback)return!0;return!1}};t.bind=t.on,t.unbind=t.off;var n=function(){},a=function(t,a,i){var r;return r=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return t.apply(this,arguments)},e.extend(r,t),n.prototype=t.prototype,r.prototype=new n,a&&e.extend(r.prototype,a),i&&e.extend(r,i),r.prototype.constructor=r,r.__super__=t.prototype,r},i=function(e,t){var n=a(this,e,t);return n.extend=this.extend,n},r=function(){this.initialize.apply(this,arguments)};return e.extend(r.prototype,t,{initialize:function(){}}),r.extend=i,{BaseClass:r,Events:t}}),ABINE_DNTME.define("abine/simulateEvents",["documentcloud/underscore"],function(){return function(){function e(e,n){var a,s=e.ownerDocument,o=t(r,arguments[2]||{}),l=null;for(var d in i)if(i[d].test(n)){l=d;break}if(!l)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");if(s.createEvent)"HTMLEvents"==l?(a=s.createEvent(l),a.initEvent(n,o.bubbles,o.cancelable)):a=new s.defaultView.MouseEvent(n,o),e.dispatchEvent(a);else{o.clientX=o.pointerX,o.clientY=o.pointerY;var c=s.createEventObject();a=t(c,o),e.fireEvent("on"+n,a)}return e}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(){!function(){function e(e,t,n){t=t||{};var a=e.ownerDocument||e,i=a.createEvent?a.createEvent("CustomEvent"):a.createEventObject();i.initCustomEvent&&i.initCustomEvent(t.type,!!t.bubbles,!!t.cancelable,t.detail);for(var r in t)i[r]=t[r];return setTimeout(function(){try{e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+t.type,a.createEventObject())}catch(n){var r=e["listen"+t.type];if(r)for(var s=0;s<r.length;++s)try{r[s].call(e,i)}catch(e){}}n()},0),this}function t(e,t,n){function a(e,t){try{var n=e.ownerDocument;if(n.createEventObject){var a=n.createEventObject();e.fireEvent("on"+t,a)}else a=n.createEvent("HTMLEvents"),a.initEvent(t,!0,!0),e.dispatchEvent(a)}catch(e){}}var i=!0,r=e.className&&e.className.indexOf("fancified")!=-1;if(window.jQuery){var s=window.jQuery(e);try{if(s.selectBoxIt)s.selectBoxIt("selectOption",s.val());else if(s.data("chosen")||s.chosen)s.trigger("chosen:updated").trigger("liszt:updated");else if(s.data("chooserElement"))s.trigger("change");else if(s.fancySelect)s.get("fancySelect").select("value",s.val());else if(s.selectBox)s.selectBox("value",s.val());else if(s.selectric)s.selectric("refresh");else if(s.coreUISelect){var o=s.data("coreUISelect");o.isSelectShow=!0,o.changeDropdownData(),o.isSelectShow=!1}else if(s.data("myJSPulldownObject")){var l=s.data("myJSPulldownObject");l.setToValue(s.val())}else if(s.fancyfields)s.setVal(s.val());else if(s.data("select2"));else if(s.data("selectize"))i=!1,s.data("selectize").setValue(s.val());else if(s.hasClass("fancified"))s.trigger("update");else if(s.selectmenu){var d=s.val();try{s.selectmenu("value",s[0].options[0].value)}catch(e){}s.selectmenu("value",d)}else s.hasClass("select-hidden")&&s.next("div.select-styled").length&&s.next("div.select-styled").next(".select-options").length&&(ulElement=s.next("div.select-styled").next(".select-options"),liElement=ulElement.find("li[rel='"+s.val()+"']"),liElement.click());s.trigger("change")}catch(e){}}i&&(r&&a(e,"update"),a(e,"change"),a(e,"blur")),n()}function n(t,n,a,i){var r=t.value;e(t,{type:"keydown",keyCode:n,which:n,charCode:n,bubbles:!0},function(){e(t,{type:"keypress",keyCode:n,which:n,charCode:n,bubbles:!0},function(){setTimeout(function(){var s=t.value;r==s&&(t.value=a),e(t,{type:"input",keyCode:n,which:n,charCode:n,bubbles:!0},function(){e(t,{type:"keyup",keyCode:n,which:n,charCode:n,bubbles:!0},function(){i()})})},1)})})}function a(e,t,i,r){if(!t||""==t)return void r();var s=t.charCodeAt(0);i+=t.charAt(0),n(e,s,i,function(){a(e,t.substring(1),i,r)})}function i(t,n,a){if(window.abineTriggerChangeInProgress)return void setTimeout(function(){i(t,n,a)},100);var r=!0;window.abineTriggerChangeInProgress=!0;try{if(window.jQuery){var s=window.jQuery(t);s.data("rawMaskFn")||s.mask||s.CardPhoneFormatting?s.focus().val(n).trigger("input").trigger("paste"):s.next(".inner").find(".options").length&&(r=!1,optionsContainer=s.next(".inner").find(".options"),optionElements=optionsContainer.find("span"),optionElements.each(function(){optionElement=$(this),optionElementHtml=$(optionElement).html(),optionElementHtml.toLowerCase().indexOf(n)>-1&&$(optionElement).click()}))}}catch(e){}r?e(t,{type:"change"},function(){e(t,{type:"blur"},function(){try{var e=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(e)}catch(e){}window.abineTriggerChangeInProgress=!1,a()})}):(window.abineTriggerChangeInProgress=!1,a())}function r(t,n,r){try{t.ownerDocument.defaultView.focus()}catch(e){}e(t,{type:"focus"},function(){e(t,{type:"click"},function(){a(t,n+"\n","",function(){i(t,n,function(){e(document,{type:"abineFilled"},function(){r()})})})})})}function s(n,a,i,r){var s=/[\s]+/g,o=(a||"").toLowerCase().replace(s,""),l=function(){e(document,{type:"abineFilled"},function(){r()})},d=!1,c=!1,m=n.getElementsByTagName("option");if(m&&m.length>0){for(var u=-1,h=0;h<m.length;h++){var p=(m[h].text||"").toLowerCase().replace(s,""),_=(m[h].getAttribute("value")||"").toLowerCase().replace(s,"");if(_==o||p==o){m[h].selected||(d=!0,m[h].selected=!0),c=!0;break}u==-1&&p.indexOf(o)!=-1&&(u=h)}c||u==-1||i||m[u].selected||(d=!0,m[u].selected=!0,c=!0)}n.setAttribute("abineFillResponse",c),d?t(n,a,l):l()}function o(){var e=document.getElementsByClassName("abineFillTarget");if(e.length>0)return e[0];for(var t=0;t<frames.length;t++)try{var e=frames[t].document.getElementsByClassName("abineFillTarget");if(e.length>0)return e[0]}catch(e){}return null}function l(){var n=document.createElement("div");n.id="abineFillElement","undefined"!=typeof paypal&&n.setAttribute("data-paypal","1"),"undefined"!=typeof OffAmazonPayments&&n.setAttribute("data-amazon","1"),"undefined"!=typeof MasterPass&&n.setAttribute("data-masterpass","1"),document.documentElement.appendChild(n),n.addEventListener("fill",function(){var t=o();if(t){var a=n.getAttribute("value");r(t,a,function(){})}else e(document,{type:"abineFilled"},function(){})},!1),n.addEventListener("fillSelect",function(){var t=o();if(t){var a=n.getAttribute("value"),i=!!n.getAttribute("skipPartial");s(t,a,i,function(){})}else e(document,{type:"abineFilled"},function(){})}),n.addEventListener("triggerChange",function(){var e=o(),a=n.getAttribute("value");e&&(e.nodeName.match(/select/i)?t(e,a,function(){}):i(e,a,function(){}))})}l()}()}function a(){return"("+n+")()"}var i={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},r={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},s={simulate:e,getAsyncFillString:a,asyncFillFunctions:n};return s}.call(this)}),ABINE_DNTME.define("abine/filler",["documentcloud/underscore","jquery","abine/timer","abine/simulateEvents"],function(e,t,n,a){var i=n.setTimeout;return function(){var n={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",BQ:"British Antarctic Territory",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CT:"Canton and Enderbury Islands",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta and Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CP:"Clipperton Island",CC:"Cocos [Keeling] Islands",CO:"Colombia",KM:"Comoros",CD:"Congo [DRC]",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",NQ:"Dronning Maud Land",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands [Islas Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",FQ:"French Southern and Antarctic Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JT:"Johnston Island",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LS:"Lesotho",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia [FYROM]",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",FX:"Metropolitan France",MX:"Mexico",FM:"Micronesia",MI:"Midway Islands",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NT:"Neutral Zone",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",VD:"North Vietnam",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",QO:"Outlying Oceania",PC:"Pacific Islands Trust Territory",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PZ:"Panama Canal Zone",PY:"Paraguay",YD:"People's Democratic Republic of Yemen",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"R&eacute;union",BL:"Saint Barth&eacute;lemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",CS:"Serbia and Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",ST:"S&atilde;o Tom&eacute; and Pr&iacute;ncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",PU:"U.S. Miscellaneous Pacific Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:["United States of America","United States"],UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WK:"Wake Island",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",AX:"&Aring;land Islands"},r={AK:"Alaska",AL:"Alabama",AP:"Armed Forces Pacific",AR:"Arkansas",AS:"American Samoa",AZ:"Arizona",CA:"California",CO:"Colorado",CT:"Connecticut",DC:"District of Columbia",DE:"Delaware",FL:"Florida",FM:"Federated States of Micronesia",GA:"Georgia",GU:"Guam",HI:"Hawaii",IA:"Iowa",ID:"Idaho",IL:"Illinois",IN:"Indiana",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",MA:"Massachusetts",MD:"Maryland",ME:"Maine",MH:"Marshall Islands",MI:"Michigan",MN:"Minnesota",MO:"Missouri",MP:"Northern Mariana Islands",MS:"Mississippi",MT:"Montana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NV:"Nevada",NY:"New York",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",PR:"Puerto Rico",PW:"Palau",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VA:"Virginia",VI:"Virgin Islands",VT:"Vermont",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},s={1:"US",43:"AT",49:"DE",32:"BE",45:"DK",358:"FI",33:"FR",353:"IE",39:"IT",31:"NL",48:"PL",351:"PT",27:"ZA",34:"ES",46:"SE",44:"GB"},o={"short":"jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec".split(","),"long":"january,february,march,april,may,june,july,august,september,october,november,december".split(",")},l=/macys\.com|bathandbodyworks\.com/,d=/[\s]+/g,c=function(e,t,n,a){this.document=e,this.domain=t,this.asyncFilling=t&&t.match(n),this.caller=a,this.injectFormFillingScript()};return c.prototype={injectFormFillingScript:function(){var t=a.getAsyncFillString(),n=this.document.createElement("script");if(n.textContent=t,(this.document.head||this.document.documentElement).appendChild(n),this.document.addEventListener("abineFilled",e.bind(this.fillFieldCallback,this),!0,!0),!this.document.getElementById("abineFillElement"))try{a.asyncFillFunctions()}catch(e){}},fillFieldCallback:function(){this.currentFillCB&&this.currentFillCB()},fillFieldAsync:function(e,t){this.currentFillCB=t;var n=this.document.createEvent("Event");n.initEvent("fill",!0,!0);var a=this.document.getElementById("abineFillElement");a.setAttribute("value",e),a.dispatchEvent(n)},triggerFieldChange:function(e,n){this.currentFillCB=null,t(e.element).addClass("abineFillTarget").attr("blurFilled",1);try{var a=this.document.createEvent("Event");a.initEvent("triggerChange",!0,!0);var i=this.document.getElementById("abineFillElement");i.setAttribute("value",n),i.removeAttribute("skipPartial");try{i.dispatchEvent(a)}catch(e){}}catch(e){}t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget")},fillSelectFieldAsync:function(e,t,n){this.currentFillCB=n;var a=this.document.createEvent("Event");a.initEvent("fillSelect",!0,!0);var i=this.document.getElementById("abineFillElement");i.setAttribute("value",e),t?i.setAttribute("skipPartial","1"):i.removeAttribute("skipPartial"),i.dispatchEvent(a)},fillTextField:function(e,n){e.setAttribute("mmautofilling","now"),t(e).val(n);try{this.triggerKeyboardEvent("keydown",e),this.triggerKeyboardEvent("keyup",e),this.triggerKeyboardEvent("keypress",e),this.triggerKeyboardEvent("change",e)}catch(e){}try{var a=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(a)}catch(e){}e.removeAttribute("mmautofilling","now")},triggerKeyboardEvent:function(e,t){var n=this.document.createEvent("KeyboardEvent");n.initKeyboardEvent?n.initKeyboardEvent(e,!0,!0,null,!1,!1,!1,!1,9,0):n.initKeyEvent&&n.initKeyEvent(e,!0,!0,null,!1,!1,!1,!1,9,0),t.dispatchEvent(n)},fillFields:function(t,n,a,i,r,s,o){this.formStrategy=t,"current"==n?this.fillCurrentFieldAsync(a,i,r,s,o):"email"==n?this.fillEmailFieldsAsync(a,i,r,s,o):"password"==n?this.fillPasswordFieldsAsync(a,i,r,s,o):"login"==n||"login-no-submit"==n?this.fillLoginFieldsAsync(a,i,r,s,o):"phone"==n?this.fillPhoneFieldsAsync(a,i,r,s,o):"address"==n?this.fillAddressFieldsAsync(a,i,r,s,o):"payment"==n?this.fillPaymentFieldsAsync(a,i,r,s,e.bind(function(){i.address&&this.hasVisibleField("/contact/postaladdress")?this.fillAddressFieldsAsync(a,i.address,r,s,o):o()},this)):"identity"==n&&this.fillIdentityFieldsAsync(a,i,r,s,o)},_elementInDocument:function(e){for(var t=e.ownerDocument;e=e.parentNode;)if(e==t)return!0;return!1},hasVisibleField:function(t){var n=this.formStrategy.getFields(),a=this,i=e.find(n,function(e){return!(!e.dataType||e.dataType!=t&&e.dataType.indexOf(t+"/")==-1)&&a.isVisible(e.element)});return!!i},reloadFieldElement:function(e){try{if(!this._elementInDocument(e.element)){var n=e.element.ownerDocument,a=null;if(e.id&&(a=n.getElementById(e.id)),!a&&e.name){var i=t("input[name="+e.name+"]",n);1==i.length&&(a=i[0])}if(!a&&e.className){var r="."+e.className.replace(/(^[\s]+)|([\s]+$)/g,"").replace(/[\s]+/g,".");i=t("select"==e.fieldType?"select"+r:"input"+r),1==i.length&&(a=i[0])}a&&(e.element=a)}}catch(e){}},reloadFormIfRequired:function(t){var n=this,a=e.find(t,function(e){return!n.isVisible(e.element)});if(a){var i=n.formStrategy.refreshOnFormChange(t);if(i!==t){for(var r in t)delete t[r];for(var r in i)t[r]=i[r]}}return t},fillFieldsValuesByType:function(n,a,i,r,s,o,l,d,c){if(t.isArray(r)){var m=this;e.async.series(r.map(function(e){return function(){m.fillFieldsByType(n,a,i,e,s,o,l,d,c)}}),c)}else this.fillFieldsByType(n,a,i,r,s,o,l,d,c)},fillFieldsByType:function(n,a,r,s,o,d,c,m,u){var h=!1;if(u=u||function(){},null===s||""==s||"undefined"==typeof s)return u(!1),!1;var p=this.getFieldsOfType(a,n,d,r,c),_=p.length;if(p=this.removedFieldsAlreadyFilled(p,s),_!=p.length&&(h=!0),0==p.length)return u(h),h;e(p).each(e.bind(function(e){e.element.setAttribute("mmautofilling","now"),t(e.element).removeData("abineManualTyped"),e.oldVal=t(e.element).val(),e.oldVal&&""!=e.oldVal&&"select"!=e.fieldType&&t(e.element).val("")},this));var f=!1;e(["uniqlo.com"]).contains(this.domain)&&(f=!0);var g=this;return e(p).each(e.bind(function(n){function d(e){var n="select"!=e.fieldType&&!g.domain.match(l)&&e.oldVal!=t(e.element).val();if(t(e.element).data("mmFillType",r),n&&(g.triggerFieldChange(e,s),f))try{t(e.element).click()}catch(e){}delete e.oldVal,o&&(e.disposableGUID=o.disposableGUID,g.formStrategy.triggerPanelFillEvent({domain:o.domain,origin:o.origin,accountId:o.accountId,field:e}))}if("select"!=n.fieldType){var c=["tdameritrade.com"];c.indexOf(g.domain)==-1&&t(n.element).focus()}if(r&&r.match("/password")&&"text"==n.element.type){try{t(n.element).val(s)}catch(e){}var u=n.element.form;i(e.bind(function(n){var i=t("[type='password']",u);if(i.length>0){var r=e(a).find(function(e){return e.element==i[0]});n=r||n;try{i.focus()}catch(e){}t(i).val(s),g.markFieldFilled(n),d(n)}else d(n)},g,n),100)}else{s+="","select"!=n.fieldType?t(n.element).val(s):h=g.setSelectValue(n,s,m);var p;if(p="select"==n.fieldType?g.getSelectValue(n.element):t(n.element).val(),p==s){if(h=!0,"select"==n.fieldType&&r.match(/month/i)){var _=g.getSelectValues(n.element),b=_[_.length-1];if(11==parseInt(b)){var y=parseInt(s)-1;g.setSelectValue(n,y,m)}}n.maxlength&&s.length>n.maxlength&&(h=!1)}g.markFieldFilled(n),d(n)}},this)),e(p).each(e.bind(function(e){e.element.removeAttribute("mmautofilling")},this)),u(h),h},markFieldFilled:function(e){t(e.element).css({color:"#0000aa","background-color":"#ffffee"})},isVisible:function(e){try{return t(e).is(":visible")&&"hidden"!=t(e).css("visibility")}catch(e){}return!0},getMonthAlternates:function(e){var t=[],n=parseInt(e);return t.push(o["long"][n-1]),t.push(o["short"][n-1]),n<10?(t.push("0"+n),t.push(""+n)):t.push(""+n),t},postFillAsync:function(e,n,a,i,r,s,o){var l=this;t(e.element).data("mmFillType",n),l.markFieldFilled(e);var d;if(d="select"==e.fieldType?l.getSelectValue(e.element):t(e.element).val(),s||d==a){if(s=!0,"select"==e.fieldType&&n.match(/month/i)&&!isNaN(parseInt(a))){var c=l.getSelectValues(e.element),m=c[c.length-1];if(11==parseInt(m)){var u=parseInt(a)-1;l.setSelectValue(e,u)}}e.maxlength&&a.length>e.maxlength&&(s=!1)}delete e.oldVal,i&&(e.disposableGUID=i.disposableGUID,l.formStrategy.triggerPanelFillEvent({domain:i.domain,origin:i.origin,accountId:i.accountId,field:e})),o(s)},getSelectOptions:function(e){var n,a=t(e).data("selectize"),i=[];if(a){n=a.options;for(var r in n)i.push({text:n[r].text,value:n[r].value})}else{n=e.options;for(var s=0;s<n.length;s++)i.push({text:n[s].text,value:n[s].value})}return i},getSelectTextValues:function(t){return e.map(this.getSelectOptions(t),function(e){return e.text})},getSelectValues:function(t){return e.map(this.getSelectOptions(t),function(e){return e.value})},getSelectValue:function(e){var n=t(e).data("selectize");return n?n.getValue():t(e).val()},setSelectValue:function(e,t,n){var a=e.element,i=!1,r=!1,s=(t||"").toString().toLowerCase().replace(d,""),o=a.getElementsByTagName("option");if(o&&o.length>0){for(var l=-1,c=0;c<o.length;c++){var m=(o[c].text||"").toLowerCase().replace(d,"");if(o[c].getAttribute("value")==t||m==s){o[c].selected||(o[c].selected=!0,i=!0),r=!0;break}l==-1&&m.indexOf(s)!=-1&&(l=c)}r||l==-1||n||(o[l].selected||(i=!0,o[l].selected=!0),r=!0)}return i&&this.triggerFieldChange(e,t),r},fillFieldOfTypeAsync:function(e,n,a,i,r,s){var o=this;"select"==e.fieldType?(t(e.element).addClass("abineFillTarget"),this.fillSelectFieldAsync(a,r,function(){t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget");var l="true"==t(e.element).attr("abineFillResponse");t(e.element).removeAttr("abineFillResponse"),o.postFillAsync(e,n,a,i,r,l,s)})):(t(e.element).addClass("abineFillTarget"),this.fillFieldAsync(a,function(){t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget");var l="true"==t(e.element).attr("abineFillResponse");t(e.element).removeAttr("abineFillResponse"),o.postFillAsync(e,n,a,i,r,l,s)}))},findAndFillRemovedFieldAsync:function(e,t,n,a,i,r){var s,o=this;if(e.id&&""!=e.id&&(s=o.document.getElementById(e.id)),!s&&e.name&&""!=e.name){var l=o.document.getElementsByName(e.name);1==l.length&&(s=l[0])}s?(e.element=s,o.fillFieldOfTypeAsync(e,t,n,a,i,function(e){r(e)})):r(!1)},fillFieldsOfTypeAsync:function(e,n,a,r,s,o,l){var d=this,c=null;return 0==e.length?void l(o):(c=e.shift(),void d.fillFieldOfTypeAsync(c,n,a,r,s,function(m){o=o||m;var u=c.element.ownerDocument;t.contains(u.documentElement,c.element)?i(function(){d.fillFieldsOfTypeAsync(e,n,a,r,s,o,l)},100):d.findAndFillRemovedFieldAsync(c,n,a,r,s,function(t){o=o||t,d.fillFieldsOfTypeAsync(e,n,a,r,s,o,l)})}))},getFieldsOfType:function(n,a,i,r,s){var o=this,l=e(n).filter(function(e){if(o.reloadFieldElement(e),null==r&&e.signature==a)return!0;if(e.signature!=a){var n=t(e.element);if(n.data("abineManualTyped")){if(""!=n.val())return!1;n.removeData("abineManualTyped")}}return e.dataType&&(!i&&e.dataType.indexOf(r)!=-1||i&&e.dataType==r)&&(s||o.isVisible(e.element))});return l},removedFieldsAlreadyFilled:function(n,a){var i=(a+"").toLowerCase().replace(d,"");return e(n).filter(function(e){if("select"==e.fieldType&&e.element.selectedIndex>=0){var n=(t(e.element).val()||"").toString();if(n==a||n.toLowerCase().replace(d,"")==i)return!1;try{var r=e.element.options[e.element.selectedIndex].text;if(r==a||r.toLowerCase().replace(d,"")==i)return!1}catch(e){}}return!0})},fillFieldsValuesByTypeAsync:function(n,a,i,r,s,o,l,d,c){if(t.isArray(r)){var m=this;e.async.series(r.map(function(e){return function(t){m.fillFieldsByTypeAsync(n,a,i,e,s,o,l,d,t)}}),c)}else this.fillFieldsByTypeAsync(n,a,i,r,s,o,l,d,c)},fillFieldsByTypeAsync:function(n,a,i,r,s,o,l,d,c){if(!this.asyncFilling)return this.fillFieldsByType(n,a,i,r,s,o,l,d,c);var m=this,u=!1;if(c=c||function(){},null===r||""==r||"undefined"==typeof r)return c(),u;r+="";var h=this.getFieldsOfType(a,n,o,i,l),p=h.length;if(h=this.removedFieldsAlreadyFilled(h,r),p!=h.length&&(u=!0),0==h.length)return c(u),u;e(h).each(e.bind(function(e){e.element.setAttribute("mmautofilling","now"),t(e.element).removeData("abineManualTyped"),e.oldVal=t(e.element).val(),e.oldVal&&""!=e.oldVal&&t(e.element).val("")},this));var m=this;m.fillFieldsOfTypeAsync(e.clone(h),i,r,s,d,u,function(t){e(h).each(function(e){e.element.removeAttribute("mmautofilling")}),c(t)})},fillCurrentFieldAsync:function(e,t,n,a,i){var r=this.formStrategy.getFields(),s={domain:n,origin:a};i=i||function(){},a&&a.origin&&(s=a,s.domain=n),this.fillFieldsByTypeAsync(e,r,null,t,s,!1,null,null,i)},fillEmailFieldsAsync:function(e,t,n,a,i){var r=this.formStrategy.getFields(),s={domain:n,origin:a};i=i||function(){},a&&a.origin&&(s=a,s.domain=n),this.fillFieldsByTypeAsync(e,r,"/contact/email",t,s,!1,null,null,i)},fillPasswordFieldsAsync:function(e,t,n,a,i){var r=this.formStrategy.getFields(),s={domain:n,origin:a},o=!1;i=i||function(){},a&&a.origin&&(s=a,s.domain=n,o=s.exactTypeMatch),this.fillFieldsByTypeAsync(e,r,"/password",t,s,o,null,null,i)},fillPhoneFieldsAsync:function(t,a,i,r,o){var l=this.formStrategy.getFields(),d={domain:i,origin:r};o=o||function(){};var c=l[t],m="";c&&c.dataType&&c.dataType.match(/work|home|mobile/)&&c.dataType.match(/phone/)&&(m="/"+c.dataType.split("/").pop());var u,h,p,_,f=a.country_code,g=a.number;1===parseInt(f)?(u=g.substr(0,3),p=g.substr(3,3),_=g.substr(6,4),h=p+"-"+_):h="+"+f+g;var b=this,y=!1;e.async.series([function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone/countrycode"+m,f,null,null,null,!0,function(a){a?(y=!0,e()):b.fillFieldsByType(t,l,"/contact/phone/countrycode"+m,s[f],null,null,null,!0,function(a){a?(y=!0,e()):b.fillFieldsValuesByType(t,l,"/contact/phone/countrycode"+m,n[s[f]],null,null,null,!1,function(n){n?(y=!0,e()):b.fillFieldsByType(t,l,"/contact/phone/countrycode"+m,f,null,null,null,!1,function(t){y=t,e()})})})})},function(e){y||"3"!=f[0]&&"4"!=f[0]||(g="0"+g),b.fillFieldsByTypeAsync(t,l,"/contact/phone/full",g,d,!0,null,null,function(){e()})},function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone"+m,g,d,!0,null,null,function(){e()})},function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone/number"+m,h,null,null,null,null,function(){e()})},function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone/areacode"+m,u,null,null,null,null,function(){e()})},function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone/exchange"+m,p,null,null,null,null,function(){e()})},function(e){b.fillFieldsByTypeAsync(t,l,"/contact/phone/local"+m,_,null,null,null,null,function(){e()})}],function(){o()})},fillBirthDateAsync:function(e,t,n,a,i,r,s){var o=this.getMonthAlternates(a),l=this;this.fillAlternatesAsync(e,t,"/birthdate/birthmonth",o,!1,!0,function(){l.fillFieldsByTypeAsync(e,t,"/birthdate/birthyear",n,r,!1,null,null,function(){l.fillFieldsByTypeAsync(e,t,"/birthdate/birthday",i,r,!1,null,null,s)})})},fillIdentityFieldsAsync:function(n,a,r,s,o){var l=this.formStrategy.getFields(),d={domain:r,origin:s};o=o||function(){};var c=this;e.async.series([function(e){var t=[];a.first_name&&t.push(a.first_name),a.middle_name&&t.push(a.middle_name),a.last_name&&t.push(a.last_name),c.fillFieldsByTypeAsync(n,l,"/nameperson/full",t.join(" "),d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/nameperson/first",a.first_name,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/nameperson/middle",a.middle_name,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/nameperson/last",a.last_name,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/person/gender",a.gender,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/nameperson/friendly",a.username,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/url",a.url,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/company/name",a.company,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/company/position",a.designation,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/socialSecurityNumber",a.ssn,d,!1,null,null,function(){e()})},function(e){c.fillFieldsByTypeAsync(n,l,"/driverLicense",a.ssn,d,!1,null,null,function(){e()})},function(e){a.dob_year&&a.dob_day?c.fillBirthDateAsync(n,l,a.dob_year,a.dob_month,a.dob_day,d,function(){e()}):e()},function(e){a.address?(delete a.address.first_name,delete a.address.last_name,c.hasVisibleField("/contact/postaladdress")?c.fillAddressFieldsAsync(n,a.address,r,s,function(){e()}):e()):e()},function(e){a.email?c.fillEmailFieldsAsync(n,a.email,r,s,function(){e()}):a.masked_email?c.fillEmailFieldsAsync(n,a.masked_email,r,"disposable",function(){e()}):e()},function(e){a.password?c.fillPasswordFieldsAsync(n,a.password,r,{origin:"strong",exactTypeMatch:!0},function(){e()}):e()},function(e){a.phone?c.fillPhoneFieldsAsync(n,a.phone,r,s,function(){e()}):e()},function(n){var r=e.find(l,function(e){return"/financial/creditcard/number"==e.dataType&&t(e.element).is(":visible")});r&&"mask"==a.card&&i(function(){r.element.scrollIntoView(),t(r.element).data("abine-params",{step:"new_card"}),t(r.element).trigger("showpanel")},100),n()}],function(){o()})},fillLoginFieldsAsync:function(e,n,a,i,r){var s=this.formStrategy.getFields(),o={domain:a,origin:i,accountId:n.accountId};i&&i.origin&&(o=i,o.domain=a);var l=s[e],d="";l&&l.dataType&&l.dataType.indexOf("/login")!=-1&&(d="/login");var c=function(e){a.match(/squarespace.com/)&&t("input[mmautofilling]",m.document).each(function(e,t){t.removeAttribute("mmautofilling")}),r(e)},m=this,u=a in{"myclubwyndham.com":1,"identityiq.com":1};m.fillFieldsByTypeAsync(e,s,"/contact/email"+d,n.email,o,null,u,null,function(){m.fillFieldsByTypeAsync(e,s,"/nameperson/friendly",n.username,o,null,u,null,function(){"changepassword"!=o.origin?m.fillFieldsByTypeAsync(e,s,"/password"+d,n.password,o,!0,u,null,c):m.fillFieldsByTypeAsync(e,s,"/passwordold",n.password,o,!0,null,null,c)})})},fillCountryFieldsAsync:function(t,a,r,s,o,l,d){function c(){var t=1;e.contains(["ebay.com"],r)&&(t=500),e.contains(["sierratradingpost.com"],r)&&(t=1500),i(function(){d()},t)}var m=this,u=!0;a&&a in n?m.fillFieldsValuesByTypeAsync(t,s,"/contact/country"+o,n[a],l,!1,u,!0,function(e){return e?void c():void m.fillFieldsByTypeAsync(t,s,"/contact/countrycode"+o,a,l,!1,u,!0,function(e){return e?void c():void m.fillFieldsByTypeAsync(t,s,"/contact/country"+o,a,l,!1,u,!0,function(e){return e?void c():void m.fillFieldsByType(t,s,"/contact/country"+o,"US"==a?"USA":null,l,!1,u,!0,function(e){return e?void c():void m.fillFieldsValuesByTypeAsync(t,s,"/contact/country"+o,n[a],l,!1,u,null,function(){c()})})})})}):m.fillFieldsByTypeAsync(t,s,"/contact/country"+o,a,l,!1,u,null,function(){c()})},fillAddressFieldsAsync:function(t,n,a,s,o){var l=this.formStrategy.getFields(),d={domain:a,origin:s},o=o||function(){},c="",m=l[t];if(m&&m.dataType){var u=m.dataType.split("/");if(u.length>3&&(c="/"+u.pop(),c.match(/bill|ship|home|business/)||(c="")),""==c&&m.multipleAddress){var h={};e.each(l,function(e){return"addressGroup"in e?void(e.addressGroup===m.addressGroup&&(h[e.signature]=e)):void(h[e.signature]=e)}),l=h}}if(m&&"addressGroup"in m)e.each(l,function(e){"addressGroup"in e&&e.addressGroup===m.addressGroup&&(e.addressFilled=!0)});else{var h={};e.each(l,function(e){e.addressFilled||(h[e.signature]=e),!e.addressFilled&&"addressGroup"in e&&(e.addressFilled=!0)}),l=h}var p=this,_=this.getFieldsOfType(l,t,!1,"/contact/state"+c,!1),f=!0;_.length>0&&(f=!1),e.async.series([function(e){p.fillCountryFieldsAsync(t,n.country,a,l,c,d,function(){e()})},function(e){l=p.formStrategy.refreshOnFormChange(l),e()},function(e){var a=[];n.first_name&&a.push(n.first_name),n.last_name&&a.push(n.last_name),p.fillFieldsByTypeAsync(t,l,"/nameperson/full",a.join(" "),d,!1,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/nameperson/first",n.first_name,d,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/nameperson/last",n.last_name,d,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/postaladdress"+c,n.address1,d,!0,null,null,function(){e()})},function(e){c?e():p.fillFieldsByTypeAsync(t,l,"/contact/postaladdress/",n.address1,d,!1,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/postaladdressAdditional"+c,n.address2,d,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/city"+c,n.city,d,null,null,null,function(){e()})},function(t){var n=1;
e.contains(["express.com"],a)&&(n=1500),i(t,n)},function(e){l=p.formStrategy.refreshOnFormChange(l),p.fillFieldsByTypeAsync(t,l,"/contact/postalcode"+c,n.zip,d,null,null,null,function(){e()})},function(t){var n=500;e.contains(["express.com"],a)&&(n=1500),i(t,n)},function(e){l=p.formStrategy.refreshOnFormChange(l),p.fillFieldsByTypeAsync(t,l,"/contact/state/code"+c,n.state,d,!1,f,null,function(a){return a?void e():void(n.state&&n.state in r?p.fillFieldsByTypeAsync(t,l,"/contact/state"+c,r[n.state],d,!1,f,!1,function(a){a?e():p.fillFieldsByTypeAsync(t,l,"/contact/state"+c,n.state,d,!1,f,!0,function(){e()})}):p.fillFieldsByTypeAsync(t,l,"/contact/state"+c,n.state,d,!1,f,null,function(){e()}))})}],function(){o()})},fillIssuedToFieldsAsync:function(e,t,n,a){var i=this;n?i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto",n,null,!0,null,null,function(){var r=n.split(" ");i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto/first",r[0],null,null,null,null,function(){r.length>1?i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto/last",r[1],null,null,null,null,function(){a()}):a()})}):a()},fillAlternatesAsync:function(e,t,n,a,i,r,s){var o=this,l=null;return a&&0!=a.length?(l=a.shift(),void this.fillFieldsByTypeAsync(e,t,n,l,null,i,r,null,function(l){l?s():o.fillAlternatesAsync(e,t,n,a,i,r,s)})):void s()},fillPaymentFieldsAsync:function(n,a,r,s,o){o=o||function(){};var l={domain:r,origin:s},d=this.formStrategy.getFields(),c=a.number,m=a.type,u=((a.first_name||"")+" "+(a.last_name||"")).replace(/(^[\s]+)|([\s]+$)/g,""),h=(parseInt(a.expiry_month)<10?"0":"")+parseInt(a.expiry_month),p=a.expiry_year,_=a.cvc,f=this,g=[m],b=!1;m.toLowerCase().indexOf("master")!=-1?g=["master","master card","mastercard"]:m.match(/amex|american/i)&&(g=["american_express","amex","american express"],b=!0),f.fillAlternatesAsync(n,d,"/financial/creditcard/type",g,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number",c,l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/part1",c.substr(0,4),l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/part2",c.substr(4,4),l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/part3",c.substr(8,4),l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/part4",c.substr(12,4),l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/amex/part1",b?c.substr(0,4):null,l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/amex/part2",b?c.substr(4,6):null,l,null,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/number/amex/part3",b?c.substr(10,5):null,l,null,null,null,function(){var a=500;e.contains(["jjill.com"],r)&&(a=2500),e.contains(["bestbuy.com"],r)&&(f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/verification",_,l,null,null,null,function(){}),a=1e3),i(e.bind(function(){d=f.formStrategy.refreshOnFormChange(d);var a=f.getMonthAlternates(h);f.fillAlternatesAsync(n,d,"/financial/creditcard/expirymonth",a,!1,!0,function(){var a=parseInt(p)%100;f.fillAlternatesAsync(n,d,"/financial/creditcard/expiryyear",[p,a],!0,!0,function(){var i=[a],s=!1;e.each(d,function(e){e&&e.dataType&&"/financial/creditcard/expiryyear2"==e.dataType&&(s="select"==e.fieldType)}),s&&i.unshift(p),f.fillAlternatesAsync(n,d,"/financial/creditcard/expiryyear2",i,!1,!0,function(){f.fillIssuedToFieldsAsync(n,d,u,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/expiry",h+"/"+p,null,!0,null,null,function(){f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/expiry2",h+"/"+a,null,!0,null,null,function(){e.contains(["target.com"],r)&&t("#cvv").focus(),f.fillFieldsByTypeAsync(n,d,"/financial/creditcard/verification",_,l,null,null,null,o)})})})})})})},this),a)})})})})})})})})})},autoLogin:function(e,n){var i=n.length>0?n.at(0):null,r=i?i.get("submit_btn"):"",s=!1;if(r&&r.length>0){var o=t(r,e.ownerDocument).first();o.length>0&&(a.simulate(o[0],"mousedown"),a.simulate(o[0],"click"),s=!0)}if(!s){var o=t(":submit",e).first();o.length>0?(a.simulate(o[0],"mousedown"),a.simulate(o[0],"click")):t(e).submit()}}},c}.apply(this,[])}),ABINE_DNTME.define("abine/proxies",["documentcloud/underscore","abine/core","abine/contentMessenger","abine/timer"],function(e,t){function n(e,t){if(!i){t=t||function(){},i=e||ABINE_DNTME.contentMessenger;var n=""+Math.random();i.once("background:stub:response:"+n,function(e){t(e)}),i.send("contentManager:proxy:connect",n)}}function a(){i&&(i=null)}var i,r=t.BaseClass.extend({initialize:function(t){var n=this;e.each(t.methods,function(e){n.addMethod(e)}),e.each(t.asyncMethods,function(e){n.addAsyncMethod(e)}),this._require=t.require},addMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.call({method:e,params:n},t)}},addAsyncMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.callAsync({method:e,params:n},t)}},call:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&i.once("background:stub:response:"+n,function(e){t(e)}),i.send("contentManager:proxy:call",e)},callAsync:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&i.once("background:stub:response:"+n,function(e){t(e.err,e.data)}),i.send("contentManager:proxy:callAsync",e)}}),s=new r({require:"abine/securityManager",methods:["isLocked","login","isInitialized","openPage","openPostInstall","openLink","refreshData","refreshRules","resetData","openWindow","isMaskmeInstalled","getBillingManager"]}),o=new r({require:"abine/webapp",methods:["openHome","openDashboard","openWallet","openMasking","openEmails","openPhones","openCards","openLogin","openMaskedEmailsIn30","openPremium","openNewFeatureAdded","openSnowman","openBlacklist","openSettings","openStats","openHelp","openPasswordSetup","openDnt2UpgradePage","openPiwikCampaign","openWeeklyReport","openDntAnywhere","openForgotPassword","openFAQ","openPage","openCashForCardsFaq","openCashForCardsSignup","openUnderstandingTracking","openTour","openAccounts"]}),l=new r({require:"abine/modules/license",methods:[],asyncMethods:["sendFeedbackEmail","refreshEntitlements","refreshLastFourCardDigits","register","login","subscribe","incrementMedalsEarned","incrementMedalsEarnedWithCurrentMedals","retrieveMedalsEarned","logAction","logSplitData","logPasswordFillData","getGenericBiometricKey","logCheckout"]}),d=new r({require:"abine/modules/payments",methods:[],asyncMethods:["retrieveCardCredit","retrieveCardFee","verifyCardRequest"]}),c=new r({require:"abine/modules/panels",methods:[],asyncMethods:["getDNTMePanel","changePanelShowRate","getDNTMeGrowl"]}),m=new r({require:"abine/pageEvents",asyncMethods:["processAction"],methods:[]}),u=new r({require:"abine/modules/mappings",asyncMethods:["makeDailyMappingCheck","getOneFormMappings","getFormRules"],methods:[]}),h=new r({require:"abine/memoryStore",methods:["set"],asyncMethods:["get"]});return{Proxy:r,connect:n,disconnect:a,securityManager:s,webapp:o,licenseModule:l,paymentsModule:d,panelsModule:c,pageEventsModule:m,mappingsModule:u,memoryStore:h}}),ABINE_DNTME.define("abine/responseCodes",[],function(){return{UNKNOWN_ERROR:"unknown error",SUCCESS:"successful",ERROR:"error",SERVICE_UNAVAILABLE_ERROR:"service unavailable error",SCHEDULED_DOWNTIME:"scheduled downtime",MISSING_PARAMETERS:"missing parameters",UNAUTHORIZED:"unauthorized bad token",NO_ACCESS_FOR_FEATURE:"no access to requested feature",INVALID_PASSWORD:"invalid password",BIOMETRIC_AUTH_FAILED:"biometric auth failed",ACCOUNT_ALREADY_EXISTS:"account already exists for that email",SAVE_NEW_USER_ERROR:"error saving new user",FAILED_CREATING_TARGET_EMAIL:"failed to create target email",FAILED_TO_UPDATE_USER:"error updating user",NO_ACCOUNT_FOUND_FOR_EMAIL:"no account found for email",ACCOUNT_MARKED_FOR_DELETION:"account has been marked for deletion",ACCOUNT_HAS_BEEN_LOCKED:"account has been locked",ACCOUNT_HAS_BEEN_BANNED:"account has been banned",WRONG_PASSWORD:"wrong password",INVALID_EMAIL_ADDRESS:"invalid email address",NO_RECURLY_ACCOUNT_FOUND:"no recurly account found",MFA_CODE_REQUIRED:"mfa code required",DOWNGRADE_SCHEMA_NOT_ALLOWED:"downgrade of schema_version is not allowed",SAVE_CLIENT_DATA_ERROR:"errors saving client data",DESTROY_CLIENT_DATA_ERROR:"errors destroying client data",NO_CLIENT_DATA_FOUND:"no client data found",USER_EXISTS_FOR_CLIENT_DATA_DELETION:"cannot destroy client data when user exists",UPGRADE_REQUIRED:"upgrade required",PHONE_NOT_FOUND:"phone not found",NO_DISPOSABLE_PHONE:"no disposable phone",FAILED_TO_SAVE_PHONE:"failed to save phone",PHONE_ALREADY_VALIDATED:"phone already validated",NO_NUMBERS_AVAILABLE:"no numbers available",FAILED_TO_SEND_VERIFICATION_CODE:"failed to send verification code",WRONG_VERIFICATION_CODE:"wrong verification code",OLD_PHONE_NOT_FOUND:"old phone not found",COUNTRY_NOT_SUPPORTED:"country not supported",COUNTRY_CHANGE_NOT_SUPPORTED:"country change not supported",ERROR_CREATING_DISPOSABLE:"error creating disposable",MISSING_USER_PARAMS_ERROR_CODE:"missing user params",NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE:"no billing account for user",REQUEST_ALREADY_EXISTS_ERROR_CODE:"request already exists",NO_CARDS_AVAILABLE_ERROR_CODE:"no cards available",REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE:"requested amount over limit",REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE:"requested amount below minimum",REQUESTED_AMOUNT_INVALID_ERROR_CODE:"requested amount invalid",BILLING_FAILED_ERROR_CODE:"billing failed",BILLING_DECLINED_ERROR_CODE:"billing declined",BILLING_COMPANY_FAILED_ERROR_CODE:"billing company failed",NO_CARD_FOUND_ERROR_CODE:"no card found",NO_BILLING_TRANSACTION_FOUND_ERROR_CODE:"no billing transaction found",FRAUD_SOFT_LIMIT_REACHED:"fraud soft limit",REFUND_FAILED_ERROR_CODE:"refund failed",PROVIDER_CANCEL_FAILED_ERROR_CODE:"provider cancel failed",PROVIDER_READ_FAILED_ERROR_CODE:"provider read failed",PROVIDER_CARD_CREATION_FAILED_ERROR_CODE:"provider card creation failed",FRAUD_HARD_LIMIT_REACHED:"fraud hard limit reached",CARD_ALREADY_DEACTIVATED_ERROR_CODE:"card already deactivated",FRAUD_VERIFIED_SOFT_LIMIT_REACHED:"fraud verified soft limit",FRAUD_PLATFORM_UNAVAILABLE:"fraud verification unavailable",FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE:"high risk country ban",BILLING_IN_NON_US_ERROR_CODE:"billing in non us",GREY_LISTED_ERROR_CODE:"grey listed user",GLOBAL_SOFT_LIMIT_REACHED:"global soft limit",DUPLICATE_CARD_ERROR_CODE:"duplicate card used ban",REJECTED_DOMAIN_ERROR_CODE:"domains known to not accept masked cards",BANNED_DOMAIN_ERROR_CODE:"banned domain",SPLIT_INTRUSIVE_NON_INTRUSIVE:"7",SPLIT_INTRUSIVE_CONTROL:"8",SPLIT_INTRUSIVE_ALWAYS_REG:"9",SPLIT_INTRUSIVE_GOT_IT_REG:"10",SPLIT_INTRUSIVE_COMPLETE_SETUP_BUTTON:"11",SPLIT_WALLET_OFF:"12",SPLIT_WALLET_ON:"13",SPLIT_ICON_PANELS_CLICK_ICON_FOR_PANEL:"32",SPLIT_ICON_PANELS_SHOW_ICON_WITH_NORMAL_PANELS:"33",SPLIT_ICON_PANELS_NORMAL:"34"}}),ABINE_DNTME.define("abine/url",function(){function e(e){return e?e.toLowerCase().replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):e}function t(e){var t=e.match(s);return t&&t.length>1?t[1].toString():e}function n(e){var n=t(e);if(n.match(o)||n.match(l))return n;var a=n.split(".");if(a.length<2)return n;var s=a.pop(),d=a.pop(),c=d+"."+s;if(i.test(c)&&a.length>0&&(s=c,d=a.pop(),c=d+"."+s),r.test(c)&&a.length>0&&!n.match(/signup.wordpress.com|new.aol.com|(oauth|www).squarespace.com|secure.onsugar.com|www.tumblr.com/i)){var m=a.pop();c=m+"."+c}return c}function a(t){if(t=n(t),t.match(o))return t;var a=t.split(".");if(a.length>2){var s=a.pop(),l=a.pop(),t=l+"."+s;if(i.test(t)&&a.length>0&&(s=t,l=a.pop(),t=l+"."+s),r.test(t)&&a.length>0){var d=a.pop();return e(l+" "+d)}return e(l)}return e(a[0])}var i=/^(((co|ac|go|ed|ga|mn|nj|nc|or|ne|in|gr|ca|on|pa|qc|bc|sh|at|va|us|il|tv|me|lg|at|ny|gv|com|edu|org|net|gov|mil|biz)\...)|(163\.com)|(kiev\.ua)|(gob\.pe)|(gen\.tr)|(waw.pl)|(jus.br))$/,r=/^(((go|typepad|tumblr|blogspot|squarespace|wordpress|myshopify|blogfa|blog|blogs|blinkweb|ning|posterous|over-blog|mihanblog|appspot|webs|weebly|onsugar|ucoz|uk|pch|ecwid)(\.com|\.in))|(nic\.in)|((ucoz|spb|narod)\.ru)|(blog\.163\.com)|((gouv|free)\.fr)|(uol\.com\.br)|(web\.id)|(gob\.mx)|(blogg\.se)|(home.pl))$/,s=/^http(?:s)?\:\/\/([^/\?\#]+)/im,o=/^[0-9\.]+(:[0-9]+)?$/,l=/^localhost(:[0-9]+)?$/,d={getHostname:t,getTLD:n,getSiteName:a};return d}),ABINE_DNTME.define("abine/window",["documentcloud/underscore","abine/timer","jquery"],function(e,t,n){function a(t){var n=[];return e.each(t,function(e,t){n.push(t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})+":"+e)}),n.join(" !important;")}function i(t,n){e.each(n,function(e,n){t.setAttribute(n,e)})}var r="panel.html",s=function(){},o=function(e,n){e.documentElement?e.documentElement.appendChild(n):t.setTimeout(function(){o(e,n)},100)};return{createTab:function(t,n){function a(a){var s=e.find(a,function(e){return e.url.indexOf(r)!=-1});s||t.doNotOpenNewTab?s&&(browser.tabs.update(s.id,{active:!t.doNotActivate,url:i}),browser.windows.get(s.windowId,function(e){"minimized"==e.state&&browser.windows.update(e.id,{state:"normal"}),browser.windows.update(e.id,{focused:!0}),n()})):(browser.tabs.create({active:!0,url:i}),n())}n=n||s;var i=t.localUrl?browser.extension.getURL(t.localUrl):t.url;if(t.force)return browser.tabs.create({active:!0,url:i}),void n();var r=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");browser.tabs.query({},a)},getWebappTabs:function(t){browser.tabs.query({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/*"},function(n){var a=[];e.each(n,function(e){a.push(e.id)}),t(a)})},openWindow:function(e,t,n){browser.windows.create({url:e,width:t,height:n,focused:!0,type:"popup"})},reloadTab:function(t,n){function a(a){var s=e.find(a,function(e){return e.url.indexOf(r)!=-1});s||t.doNotOpenNewTab?s&&(browser.tabs.reload(s.id),t.doNotActivate||(browser.tabs.update(s.id,{active:!0}),browser.windows.get(s.windowId,function(e){"minimized"==e.state&&browser.windows.update(e.id,{state:"normal"}),browser.windows.update(e.id,{focused:!0}),n()}))):(browser.tabs.create({active:!0,url:i}),n())}n=n||s;var i=t.localUrl?browser.extension.getURL(t.localUrl):t.url,r=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");browser.tabs.query({},a)},createPanel:function(t){var n=t.localUrl?browser.extension.getURL(t.localUrl):t.url,s=t.document||document||window.document,l=t.panelWidth?t.panelWidth:368;if(!s)throw"Error. abine/window createPanel called without a document context.";var d=t.id||"abine"+Math.floor(1e8*Math.random());n=n?n:browser.extension.getURL(r)+"?"+d,console.log(n);var c=s.createElement("iframe"),m=s.createElement("div");return m.className=t.className||"abineContentPanel",c.className="abineContentFrame",i(m,{style:a(e.extend({backgroundColor:"transparent",margin:"0",padding:"0",display:"none",opacity:"1",filter:"alpha(opacity:100)"},t.style))}),i(c,{width:l+"px",allowTransparency:"true",frameborder:0,height:t.panelHeight+"px",scrolling:"no",src:n,id:d,style:a(e.extend({position:"relative",display:"block",background:"transparent",borderWidth:"0px",left:"0px",top:"0px",visibility:"visible",opacity:1,filter:"alpha(opacity:100)",margin:"0",padding:"0",height:t.panelHeight+"px",width:l+"px"}))}),m.appendChild(c),o(s,m,c),c},autoResizePanels:function(t){var a,i=t.document||document||window.document;i.getElementsByTagName("body")[0];if(t.frameId){var r=i.getElementById(t.frameId);r&&(a=[r.parentElement])}a||(a=i.getElementsByClassName(t.className||"abineContentPanel")),e(a).each(function(e){var a=n("iframe",e)[0];a.scrolling="no",n(a).height("auto");var i=n(a).width(),r=t.documentHeight;t.extraWidth&&(i+=t.extraWidth),t.extraHeight&&(r+=t.extraHeight),n(a).width(i),n(a).height(r),e.style.width=i+"px",e.style.height=r+"px";try{var s=parseInt(e.style.left),o=s+e.offsetWidth,l=e.ownerDocument.defaultView.innerWidth,d=e.ownerDocument.documentElement.scrollLeft+l;if(o>d){var c=o-d;if(s-c>0)e.style.left=s-c+"px";else if(e.style.left="0px",l<o-s){var m=Math.round(l/(o-s)*100);m-=1,m<80&&(m=80),a.style.zoom=m+"%",a.contentDocument.body.style.zoom=m+"%"}}}catch(e){}})},removePanels:function(t){function a(e,t){if(!t){var a=n("iframe",e);if(a.length>0&&(t=a[0]),!t)return}t.id.indexOf("doNotRemove")!=-1?n(t.parentNode).hide():t.parentNode.parentNode.removeChild(t.parentNode)}var i=t.document||document||window.document;if(t.iframe)return void a(null,t.iframe);var r=i.getElementsByClassName("abineContentPanel");e(r).each(function(e){a(e)})}}}),ABINE_DNTME.define("abine/contentMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function(e){"FWD"==e.eventName?e.payload.to==ABINE_DNTME.context&&this.trigger(e.payload.eventName,e.payload.payload,e.payload.from):this.trigger(e.eventName,e.payload)},a=function(){throw"Error. Attempt to call destroyed ContentMessenger."},i=t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),browser.runtime.onMessage.addListener(this.listener)},sendToCS:function(e,t,n){browser&&browser.extension&&browser.runtime.sendMessage({eventName:"FWD",payload:{to:e,from:ABINE_DNTME.context,eventName:t,payload:"undefined"==typeof n?{}:n}})},send:function(e,t){this.trigger(e,t),browser&&browser.extension&&browser.runtime.sendMessage({eventName:e,payload:"undefined"==typeof t?{}:t})},destroy:function(){this.off();try{browser.runtime.onMessage.removeListener(this.listener)}catch(e){}this.on=this.off=this.trigger=a}});return{ContentMessenger:i}}),ABINE_DNTME.define("abine/assets",["wycats/handlebars"],function(e){function t(e){return browser.extension.getURL(e)}function n(e,t,n){var a=e+t+n;return browser.extension.getURL(a)}return e.registerHelper("assetUrl",t),e.registerHelper("cardAssetUrl",n),{assetUrl:t,cardAssetUrl:n}}),ABINE_DNTME.define("abine/browserSyncStorage",["documentcloud/underscore","abine/core"],function(e,t){var n;n=browser&&browser.storage&&browser.storage.sync?t.BaseClass.extend({initialize:function(){},set:function(e,t){browser.storage.sync.set(e,t)},remove:function(e,t){browser.storage.sync.remove(e,t)},get:function(e,t){browser.storage.sync.get(e,t)},clear:function(e){browser.storage.sync.clear(e)}}):t.BaseClass.extend({initialize:function(){this.storage={}},set:function(t,n){e.extend(this.storage,t),n&&n()},remove:function(t,n){t="string"==typeof t?[t]:t,e.each(t,e.bind(function(e){delete this.storage[e]},this)),n&&n()},get:function(t,n){t="string"==typeof t?[t]:t,n&&n(e.pick(this.storage,t))},clear:function(e){this.storage={},e&&e()}});var a=new n({});return a}),ABINE_DNTME.define("documentcloud/backbone",["documentcloud/underscore","jquery"],function(){return Backbone}),ABINE_DNTME.define("wycats/handlebars",[],function(){var e={};e.VERSION="1.0.beta.6",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2!==arguments.length)throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";return e.registerHelper("blockHelperMissing",function(e,a){var i=a.inverse||function(){},r=a.fn,s="",o=t.call(e);if(o===n&&(e=e.call(this)),e===!0)return r(this);if(e===!1||null==e)return i(this);if("[object Array]"===o){if(e.length>0)for(var l=0,d=e.length;l<d;l++)s+=r(e[l]);else s=i(this);return s}return r(e)}),e.registerHelper("each",function(e,t){var n=t.fn,a=t.inverse,i="";if(e&&e.length>0)for(var r=0,s=e.length;r<s;r++)i+=n(e[r]);else i=a(this);return i}),e.registerHelper("if",function(a,i){var r=t.call(a);return r===n&&(a=a.call(this)),!a||e.Utils.isEmpty(a)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){var a=n.fn,i=n.inverse;return n.fn=i,n.inverse=a,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)}),e.Exception=function(){var e=Error.prototype.constructor.apply(this,arguments);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.message=e.message},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/&(?!\w+;)|[<>"'`]/g,a=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":a.test(t)?t.replace(n,i):t},isEmpty:function(e){return"undefined"==typeof e||(null===e||(e===!1||"[object Array]"===Object.prototype.toString.call(e)&&0===e.length))}}}(),e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,a){var i=this.programs[t];return a?e.VM.program(n,a):i?i:i=this.programs[t]=e.VM.program(n)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop};return function(a,i){return i=i||{},t.call(n,e,a,i.helpers,i.partials,i.data)}},programWithDepth:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(a,i){return i=i||{},e.apply(this,[a,i.data||t].concat(n))}},program:function(e,t){return function(n,a){return a=a||{},e(n,a.data||t)}},noop:function(){return""},invokePartial:function(t,n,a,i,r,s){if(options={helpers:i,partials:r,data:s},void 0===t)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(a,options);if(e.compile)return r[n]=e.compile(t),r[n](a,options);throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template,e}),ABINE_DNTME.define("duckbone/core",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars"],function(e,t){var n={};return n.helpers=n.helpers||{},n.forms=n.forms||{},n.TemplatesData=n.TemplatesData||{},n.PartialsData=n.PartialsData||{},e.extend(n,t.Events),e.extend(n,{serverError:function(t){e.log("500 Server Error"),t&&e.log(t)},fileNotFound:function(t){e.log("404 File Not Found"),t&&e.log(t)},register:function(t,a){a=a||!1;var i=e.uniqueId("regfunc");return e.isUndefined(n.registeredFunctions)&&(n.registeredFunctions={}),a&&(t=e.wrap(t,function(e){e(arguments),delete n.registeredFunctions[i]})),n.registeredFunctions[i]=t,"Duckbone.registeredFunctions."+i},wrapMethods:function(t,n){var a=Array.prototype.slice.call(arguments,2);e.isArray(a[0])&&(a=a[0]),e.each(a,function(e){var a=t[e];t[e]=function(){var e=[a].concat(Array.prototype.slice.call(arguments));return n.apply(t,e)}})},log:function(e){window.console&&console.log&&console.log(e)},include:function(t){if("undefined"==typeof t)throw"Attempt to include into undefined object.";return e.each(e.toArray(arguments).slice(1),function(e){if("undefined"==typeof e)throw"Attempt to include undefined object.";for(var n in e)"included"!=n&&void 0!==e[n]&&(t.hasOwnProperty(n)||(t[n]=e[n]));"function"==typeof e.included&&e.included.call(t)}),t}}),e.extend(n.helpers,{dateToPrettyTimeAgo:function(e){var t=Math.floor(((new Date).getTime()-e.getTime())/6e4);t<0&&(t=0);var n,a,i,r=t||0;return 0===r?"just now":(r>=1440?(a=Math.floor(r/1440),r-=1440*a,n=a,n+=a>1?" days":" day"):r>=60?(i=Math.floor(r/60),r-=60*i,n=i,n+=i>1?" hours":" hour"):r>0&&(n=r,n+=r>1?" minutes":" minute"),n+" ago")}}),e.mixin({log:n.log}),n}),ABINE_DNTME.define("duckbone/model",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,a,i){function r(n,a,r,s){var l=d("set_"+a),c=d(a),m=function(e,a){if(e instanceof t.Model){if(e===n[c])return e;n[c]&&(n.trigger("remove:"+c),s&&(n[c][s]=null)),n[c]=e,s&&o(n,n[c],s,a),n.trigger("add:"+c)}else if(e)if(n[c]){var i=function(){n.trigger("change:"+c)};n[c].on("change",i),n[c].set(e),n[c].off("change",i)}else n[c]=new r(e),s&&o(n,n[c],s,a),n.trigger("add:"+c);else n[c]&&(n.trigger("remove:"+c),s&&(n[c][s]=null)),n[c]=null;return e&&n.messenger&&!e.messenger&&(e.messenger=n.messenger),e};try{m.call(n,n.get(a),!0)}catch(e){i.error("Error creating association for "+a+":\n"+e)}delete n.attributes[a],n[l]=e.bind(m,n)}function s(e,t,n,a){try{var r=d(t),s=e.get(t),l=e[r]=new n(s);delete e.attributes[t],a&&(l[a]=e,l.each(function(t){o(e,t,a)}),l.on("add",function(t){o(e,t,a)}),l.on("remove",function(e){e[a]=null}),l.on("reset",function(t){t.each(function(t){o(e,t,a)})})),e.messenger&&!l.messenger&&(l.messenger=e.messenger)}catch(e){i.error("Error creating association for "+t+":\n"+e)}}function o(e,t,n,a){var r="set"+n.slice(0,1).toUpperCase()+n.slice(1);"function"==typeof t[r]?t[r].call(t,e,a):a?t[n]=e:i.error("To use belongsTo, model must define hasOne for "+n)}function l(n,a){var i={};return n instanceof t.Model||!this._associations?i=n:e(n).each(function(e,t){var n=this._associations[t];if("hasOne"==n){var a=d("set_"+t);this[a](e)}else if("hasMany"==n){var r=d(t);"function"==typeof this[r].freshen?this[r].freshen(e):this[r].reset(e)}else i[t]=e},this),this.setWithoutAssociations.call(this,i,a)}function d(e){return e.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_","")})}function c(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})}a.AssociableModel={isAssociableModel:!0,included:function(){this.setWithoutAssociations||(this.setWithoutAssociations=this.set,this.set=l)},hasOne:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasOne",r(this,t,e.model,e.belongsTo)},this)},hasMany:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasMany",s(this,t,e.collection,e.belongsTo)},this)}},a.ModelHelpers={simpleSave:function(e){var t={};this.id&&(e.id=this.id),this.paramRoot?t[this.paramRoot]=e:t=e;var n=JSON.stringify(t);return this.save({},{contentType:"application/json",data:n})},url:function(){var e="function"==typeof this.urlRoot?this.urlRoot():this.urlRoot,t=m(this.collection)||e||urlError();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},setOne:function(e,t,n){var a={};return a[e]=t,this.set(a,n)},createGetters:function(){var t=this,n=arguments,a={};e.each(n,function(e){getterFuncName=d(e),getterFuncName="get"+c(getterFuncName),t[getterFuncName]||(a[getterFuncName]=function(){return this.get(e)})}),e.extend(this,a)},isValidAttribute:function(t){return!e.isNaN(t)&&!e.isUndefined(t)}};var m=function(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}}),ABINE_DNTME.define("duckbone/syncable",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}function s(){throw new Error("A 'url' property or function must be specified")}function o(e){var t,n,a,i,r,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",l="",d="",c=0;do t=e.charCodeAt(c++),n=e.charCodeAt(c++),l=e.charCodeAt(c++),a=t>>2,i=(3&t)<<4|n>>4,r=(15&n)<<2|l>>6,d=63&l,isNaN(n)?r=d=64:isNaN(l)&&(d=64),o=o+s.charAt(a)+s.charAt(i)+s.charAt(r)+s.charAt(d),t=n=l="",a=i=r=d="";while(c<e.length);return o}i.Syncable={isSyncable:!0,sync:function(n,a,c){var m,u=d[n],h=a.defaultSyncOptions||{},p=e.extend({type:u,dataType:"json",beforeSend:function(e){var n=t('meta[name="csrf-token"]').attr("content");n&&e.setRequestHeader("X-CSRF-Token",n)}},h,c);if(t.browser.msie&&(p.cache=!1),p.url||(p.url=r(a)||s()),!p.data&&a&&("create"==n||"update"==n)){p.contentType="application/json";var _={};a.paramRoot?_[a.paramRoot]=a.toJSON():_=a.toJSON(),p.data=JSON.stringify(_)}return"GET"!==p.type&&(p.processData=!1),l.username&&(p.username=l.username,p.password=l.password,p.headers=p.headers||{},p.headers.Authorization="Basic "+o(p.username+":"+p.password)),m=t.ajax(p),m.params=p,a.trigger("sync:"+n.toLowerCase()),m.complete(function(){a.trigger("sync:complete",m)}),m.success(function(){delete a.errors,a.trigger("sync:success",m)}),m.error(function(e){e.status>=400&&i.trigger("sync:"+e.status,m)}),m.error(function(e){if(422==e.status){var t=JSON.parse(e.responseText);t.errors?a.errors=t.errors:a.errors=t,a.trigger("sync:invalid",m)}else a.trigger("sync:error",m)}),m}},i.setAuthenticatedUser=function(e,t){l.username=e,l.password=t},i.removeAuthenticatedUser=function(){delete l.username,delete l.password};var l={},d={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}}),ABINE_DNTME.define("duckbone/collection",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a){a.CollectionHelpers={hasDuckboneCollectionHelpers:!0,slice:function(){return this.models.slice(arguments)},toSelectOptions:function(e,t){var n={};return e=e||"title",t&&(n[" "]=" "),this.each(function(t){n[t.id]=t.get(e)}),n},freshen:function(t){var n;this.each(function(e){e._remove=!0}),e(t).each(function(e){n=this.get(e.id),n?(n.set(e),delete n._remove):this.add(e)},this);var a=this.filter(function(e){return e._remove});e(a).each(function(e){this.remove(e)},this),this.trigger("freshen",this)},fetch:function(e){e||(e={});var n=this,a=e.success;e.success=function(t,i,r){n[e.add?"add":e.freshen?"freshen":"reset"](n.parse(t,r),e),n.trigger("sync"),a&&a(n,t)};var i=e.error;return e.error=function(t){i?i(n,t,e):n.trigger("error",n,t,e)},(this.sync||t.sync).call(this,"read",this,e)}}}),ABINE_DNTME.define("duckbone/routeable_application",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.RouteableApplication={isRouteableApplication:!0,setContainer:function(e){this.mainContainer=e},mapRoutes:function(t){e.each(e.keys(t),function(n){try{var a=t[n].routeName||t[n].prototype.templateName;if(!a)throw"Missing or bad routeName for "+n;if("function"!=typeof t[n].routeAction)throw"Missing or bad routeAction for "+n;this.route(n,a,t[n].routeAction),this.route(n+"?*params",a,function(){var a=e.toArray(arguments),i=a.pop(),r=e(i.split("&")).reduce(function(e,t){return e[t.split("=")[0]]=t.split("=")[1],e},{});return t[n].routeAction.apply(this,a.concat(r))})}catch(t){throw e.log(t),"Bad route for "+n}},this)},loadView:function(e,n){return void 0===n&&(n={}),this._removableFlashes&&(this._removableFlashes.remove(),delete this._removableFlashes),this.mainView&&this.mainView.remove(),n.application=this,this.mainView=new e(n),t(this.mainView.el).appendTo(this.mainContainer),this.mainView},navigate:function(e,t){this.isFlashableView&&(this._removableFlashes=this.activeFlashes()),n.history.navigate(e,t)},bindNavigationBars:function(){this.on("all",function(e){if("route"==e.split(":")[0]){var n=e.split(":")[1];t("nav ul li").removeClass("active"),t("nav ul li."+n).addClass("active")}})}}}),ABINE_DNTME.define("duckbone/view_lifecycle_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.ViewLifecycleExtensions={hasViewLifecycleExtensions:!0,initialize:function(){this.application=this.options.application,this.messenger=this.options.messenger,this.isEditableView&&(r(this,"beforeClone"),this.cloneModelForEditing(),r(this,"afterClone")),this.render(),this.isStylizeableView&&this.applyStyles(),this.isBindableView&&this.bindAttributes(),this.isEditableView&&(this.bindModelSyncEvents(),this.createForm(),r(this,"afterCreateForm")),r(this,"afterInitialize")},render:function(){return this.isTemplateableView&&this.renderTemplate(),this.isStylizeableView&&this.applyStyles(),this},remove:function(){return this.isEditableView&&this.expireClone(),r(this,"beforeRemove"),this.removeWeakBindings(),this.isNestableView&&this.removeNestedViews(),n.View.prototype.remove.call(this),r(this,"afterRemove"),this},weakBindToModel:function(e,t,n){this.weakBindTo(this.model,e,t,n)},weakBindTo:function(t,n,a){this._weakBindings=this._weakBindings||[],this._weakBindings.push([t,n,a]),t.bind.apply(t,e.toArray(arguments).slice(1))},removeWeakBindings:function(){e.each(this._weakBindings,function(e){e[0].unbind(e[1],e[2])}),delete this._weakBindings,this.isBindableView&&this.unbindLiveTimestamps()}};var r=function(e,t){e[t]&&e[t].call(e)}}),ABINE_DNTME.define("duckbone/handlebars_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){
ABINE_DNTME.Duckbone=i,i.Handlebars=a,a.getAttr=function(e,t){return/^[0-9]+$/.test(t)?e[parseInt(t)]:void 0!=e[t]?"function"==typeof e[t]?e[t].call(e):e[t]:e.get?e.get(t):void 0}}),ABINE_DNTME.define("duckbone/idme_template_registry",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(t){t.templatesCompiled||(e.each(e.keys(ABINE_DNTME.CompiledTemplates),function(e){var n=e.replace("views/","").replace("/","_");t.compiledTemplates[n]=ABINE_DNTME.CompiledTemplates[e]}),t.templatesCompiled=!0)}i.TemplateRegistry=function(e){e=e||{},this.compiledTemplates={},this.templatesCompiled=!1,this.partialsCompiled=!1},e.extend(i.TemplateRegistry.prototype,{refresh:function(){},compile:function(){r(this)},get:function(e){return r(this),this.compiledTemplates[e]}})}),ABINE_DNTME.define("duckbone/nestable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.NestableView={isNestableView:!0,setupNestedViews:function(){this.createChildren&&(this.children=this.createChildren())},removeNestedViews:function(){this.children&&(e.each(this.children,function(e){e.remove()}),delete this.children)}}}),ABINE_DNTME.define("duckbone/templateable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,a,i,r){var s=new i.TemplateRegistry;a&&(a.helpers.oldIf=a.helpers["if"],a.registerHelper("if",function(e,t,n){var i="function"==typeof e?e.call(this):e;return a.helpers.oldIf.call(this,i,t,n)}),a.registerHelper("attr",function(e){return new a.SafeString('<span data-bind="attr_'+a.Utils.escapeExpression(e)+'">'+a.Utils.escapeExpression(this.get(e))+"</span>")}),a.registerHelper("child",function(t,n){return n=e.isObject(n)?"div":n,new a.SafeString("<"+n+' data-child-view="'+a.Utils.escapeExpression(t)+'"></'+n+">")}),a.helpers.oldEach=a.helpers.each,a.registerHelper("each",function(e,t,n){return e.models&&(e=e.models),a.helpers.oldEach.call(this,e,t,n)})),i.TemplateableView={isTemplateableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions),this.isNestableView||i.include(this,i.NestableView)},templateRegistry:s,getTemplate:function(e,t){if(this.templateData=this.options.templateData||this.templateData||null,this.templateData)throw r.error("Cannot compile template."),"Cannot compile template";return e=e||this.options.templateName||this.templateName||"",this.template=this.templateRegistry.get(e),this.template||t||(this.template=i.Handlebars.compile('<div>Missing Template "'+e+'"</div>')),this.template},renderTemplate:function(i){var i=i||this.model||{};if(e.isFunction(this.options.template)?this.template=this.options.template:this.template||this.getTemplate(),!this.template)throw"renderTemplate called without a template.";this.removeNestedViews(),this.isBindableView&&this.unbindAttributes();try{t(this.el).empty().html(this.template(i))}catch(e){r.error("Handlebars threw an exception rendering your template:"),r.error(e.message),r.error("Context:"),r.error(i),t(this.el).html('<div class="duckbone_error">Handlebars exception: '+a.Utils.escapeExpression(e.message)+"</div>")}this.isBindableView&&i instanceof n.Model&&t(this.el).find("span[data-bind]").each(e.bind(function(e,n){var a=t(n).attr("data-bind").slice(5),r='span[data-bind="attr_'+a+'"]';this.bindAttribute(i,a,r)},this)),this.setupNestedViews(),t(this.el).find("*[data-child-view]").each(e.bind(function(e,a){var i=t(a).attr("data-child-view"),s=this.children[i];s instanceof n.View?(t(a).replaceWith(s.el),t(s.el).attr({"data-child-view":i}),s.delegateEvents()):r.error("Unknown child view "+i)},this));this.options.templateName||this.templateName;return this.templateName&&t(this.el).addClass(this.templateName),this.templateRendered=!0,this},renderTemplateOnce:function(e){return this.templateRendered||this.renderTemplate(e),this}}}),ABINE_DNTME.define("duckbone/stylizeable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.StylizeableView={isStylizeableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},applyStyles:function(e){e=e||this.styles||{};var n,a;for(var i in e)n=i.split(".")[0],a=i.split(".")[1],"el"==i?t(this.el).css(e.el):"el"==n&&a&&t(this.el).hasClass(a)?t(this.el).css(e[i]):t(this.el).find(i).css(e[i])}}}),ABINE_DNTME.define("duckbone/pageable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.PageableView={isPageableView:!0,included:function(){this.isTemplateableView||i.include(this,i.TemplateableView)},getTemplate:function(e){i.TemplateableView.getTemplate.call(this,e,!0),this.template=this.template||i.Handlebars.compile('{{child "list"}}{{child "pager"}}')},createChildren:function(){var t=this.createListView(),n=this.createPagerView();return this.application=this.options.application||this.application,this.application&&this.collection.on("pageChange",function(t,n){var a=window.location.hash.split("?")[0]+"?",i=e(e.keys(n)).map(function(e){return e+"="+n[e]}).join("&");a+=i,this.application.navigate(a,!1)},this),{list:t,pager:n}},createListView:function(){return new i.ListView({viewClass:this.viewClass,pageableView:this,tagName:"ul",className:"listable_view",collection:this.collection})},createPagerView:function(){var e=this.options.pagerClass||this.pagerClass||Pager;return new e({collection:this.collection,pageableView:this})},showPage:function(e){e=parseInt(e)||1,this.collection.setPage(e)},showNextPage:function(){this.showPage(this.collection.currentPage+1)},showPreviousPage:function(){this.showPage(this.collection.currentPage-1)},scrollToTopOfList:function(){var e=t(this.children.list.el).offset().top-20;t("html body").animate({scrollTop:e},400,"swing")}};var r='<div class="pager">&nbsp;<br/>    {{#if showPrevious}}      <a href="#" class="previous_link">&laquo;&nbsp;Previous</a>&nbsp;    {{else}}      <span class="inactive">&laquo;&nbsp;Previous</span>&nbsp;    {{/if}}    {{#each pages}}      {{#if currentPage}}        <span class="current">{{title}}</span>&nbsp;      {{else}}        <a href="#" class="page_link" data-page="{{id}}">{{title}}</a>&nbsp;      {{/if}}    {{/each}}    {{#if showNext}}      <a href="#" class="next_link">Next&nbsp;&raquo;</a>    {{else}}      <span class="inactive">Next&nbsp;&raquo;</span>    {{/if}}  </div>';Pager=n.View.extend({el:'<div class="pager_view"></div>',templateData:r,events:{"click a.previous_link":"showPreviousPage","click a.next_link":"showNextPage","click a.page_link":"showPage"},initialize:function(){this.render(),this.collection.on("all",this.render,this)},render:function(){return this.collection.numPages&&this.renderTemplate(this.paginationData()),this.collection.numPages>1?t(this.el).show():t(this.el).hide(),this},paginationData:function(){var t=this.collection.numPages,n={showPrevious:this.collection.currentPage>1,numPages:t,showNext:this.collection.currentPage<this.collection.numPages,pages:e(e.range(1,t+1)).map(function(e){return{id:e,title:""+e,currentPage:e==this.collection.currentPage}},this)};return n},showPage:function(e){e.preventDefault();var n=parseInt(t(e.target).data("page"));return this.options.pageableView.showPage(n),this.options.pageableView.scrollToTopOfList(),!1},showPreviousPage:function(e){return e.preventDefault(),this.options.pageableView.showPreviousPage(),this.options.pageableView.scrollToTopOfList(),!1},showNextPage:function(e){return e.preventDefault(),this.options.pageableView.showNextPage(),this.options.pageableView.scrollToTopOfList(),!1}}),i.include(Pager.prototype,i.TemplateableView)}),ABINE_DNTME.define("duckbone/pageable_collection",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(e,t){t=t||{};var n="function"==typeof e.url?e.url():e.url;n.indexOf("?")<0&&(n+="?");for(var a in t)n+=a+"="+t[a]+"&";return n}i.PageableCollection={isPageableCollection:!0,parse:function(e){return this.numPages=e.num_pages,this.limitValue=e.limit_value,this.currentPage=e.current_page,this.totalCount=e.total_count,e.records},fetch:function(){this.fetchPage(1)},fetchPage:function(t,a){return t=t||1,a=a||e.clone(this.params)||{},n.Collection.prototype.fetch.call(this,{url:r(this,e.extend(a,{page:t})),success:function(e){e.trigger("pageChange",e.currentPage,a)}})},setParam:function(e,t){this.params=this.params||{},this.params[e]=t},setPage:function(e){if(e!=this.currentPage&&e>0&&e<=this.numPages)return this.fetchPage(e)},nextPage:function(){return this.fetchPage(this.currentPage+1)},prevPage:function(){return this.fetchPage(this.currentPage-1)},updateTotalCountOnCollectionEvents:function(){this.on("add",function(){this.totalCount&&(this.totalCount+=1)},this),this.on("remove",function(){this.totalCount&&(this.totalCount-=1)},this)}}}),ABINE_DNTME.define("duckbone/bindable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.BindableView={isBindableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},bindAttributes:function(e){if(this.attributeChanges){e=e||this.model||new n.Model;for(var t in this.attributeChanges)this.bindAttribute(e,t,this.attributeChanges[t])}},bindAttribute:function(e,i,r){e=e||this.model||new n.Model;var s,o=a.Utils.escapeExpression(e.get(i));"function"==typeof r?(r.call(this,o),s=function(){r.call(this,a.Utils.escapeExpression(e.get(i)))}):"string"==typeof r&&(t(this.el).find(r).html(o),s=function(){t(this.el).find(r).html(a.Utils.escapeExpression(e.get(i)))}),this._attributeBindings=this._attributeBindings||[];var l="change:"+i;this._attributeBindings.push([e,l,s]),this.weakBindTo(e,l,s,this)},unbindAttributes:function(){this._attributeBindings&&(e(this._attributeBindings).each(function(e){e[0].unbind(e[1],e[2])}),delete this._attributeBindings)},bindLiveTimestamps:function(e){return},unbindLiveTimestamps:function(){}},a&&a.registerHelper("live_timestamp",function(e){var t=i.Handlebars.getAttr(this,e);if(!t)return"";var n=new Date(t);return n?new a.SafeString('<span data-live-timestamp="'+n.getTime()+'">'+i.helpers.dateToPrettyTimeAgo(n)+"</span>"):""})}),ABINE_DNTME.define("duckbone/listable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(e){e.viewClass=e.options.viewClass||e.viewClass||new n.View}function s(e){e.collection=e.options.collection||e.collection||new n.Collection}i.ListableView={isListableView:!0,tagName:"ul",className:"listable_view",included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions),this.isBindableView||i.include(this,i.BindableView),this.isNestableView||i.include(this,i.NestableView)},render:function(e){return this.doc=this.doc||this.options.doc||document,this._viewsRendered&&!e||(this.renderItems(),this.collectionEventsBound||(this.bindCollectionEvents(),this.collectionEventsBound=!0),this._viewsRendered=!0),this},createChildren:function(){return e.reduce(this.collection.models,function(e,t){return e[t.cid]=new this.viewClass({model:t,doc:this.doc}),e},{},this)},renderItems:function(){r(this),s(this),this.setupNestedViews();var t=this.doc.createDocumentFragment();e.each(this.children,function(e){t.appendChild(e.el)}),this.el.appendChild(t)},bindCollectionEvents:function(e){var t;s(this),e=e||this.collectionEvents||o;for(var n in e){if(t=e[n],"string"==typeof t&&(t=this[t]),"function"!=typeof t)throw"Duckbone.ListableView.bindCollectionEvents() called with bad handler for "+n;this.weakBindTo(this.collection,n,t,this)}},refresh:function(e){e=e||{},this.empty(),this.collection.fetch()},getViewByModel:function(e){return this.children[e.cid]},collectionReset:function(){this.removeNestedViews(),this.render(!0)},collectionAdd:function(n){var a=new this.viewClass({model:n,doc:this.doc});this.children[n.cid]=a;var i=e(this.collection.models).indexOf(n);if(0==i)t(this.el).prepend(a.el);else{var r=t(this.el).children().eq(i-1);t(r).after(a.el)}},collectionRemove:function(e){this.children[e.cid].remove(),delete this.children[e.cid]}};var o={reset:"collectionReset",add:"collectionAdd",remove:"collectionRemove"}}),ABINE_DNTME.define("duckbone/flashable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.FlashableView={isFlashableView:!0,configureFlash:function(t){if(!t.container)throw"configureFlash called without a container";var n={noticeDuration:1e4,fadeDuration:300};this.flashOptions=e.extend(n,t),r.fadeDuration=this.flashOptions.fadeDuration,t.noticeTemplate&&"string"==typeof t.noticeTemplate?o.prototype.templateData=t.noticeTemplate:"function"==typeof t.noticeTemplate&&(o.prototype.template=t.noticeTemplate),t.errorTemplate&&"string"==typeof t.errorTemplate?FlashErrorView.prototype.templateData=t.errorTemplate:"function"==typeof t.errorTemplate&&(FlashErrorView.prototype.template=t.errorTemplate)},flashNotice:function(e,n){n=n||1e4;var a=new o({model:{message:e},duration:n});return t(this.flashOptions.container).append(a.el),t(a.el).hide().slideDown(300),a},flashAlert:function(e){var n=new l({model:{message:e}});return t(this.flashOptions.container).append(n.el),t(n.el).hide().slideDown(300),n},activeFlashes:function(){return t(this.flashOptions.container).find("div.flash_notice, div.flash_alert")},clearFlashes:function(e){if(this.flashOptions){var t=this.activeFlashes();e?t.remove():t.fadeOut(this.flashOptions.fadeDuration)}}};var r=n.View.extend({events:{"click a.close":"dismiss"},fadeDuration:300,dismiss:function(n){return n&&n.preventDefault(),t(this.el).fadeOut(this.fadeDuration),e.delay(e.bind(this.remove,this),this.fadeDuration),!1}});i.include(r.prototype,i.TemplateableView);var s='<div class="message">{{{message}}}</div>     <div class="close"><a href="#" class="close">X</a></div>',o=r.extend({className:"flash_notice",templateData:s,afterInitialize:function(){this.options.duration&&e.delay(e.bind(this.dismiss,this),this.options.duration)}}),l=r.extend({className:"flash_alert",templateData:s})}),ABINE_DNTME.define("duckbone/bindable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(e,t,n,a){a=a||!1,"undefined"==typeof n&&(n=null),i.ModelHelpers.setOne.call(e,t,n,{silent:a})}i.BindableField={isBindableField:!0,get:function(){var e=this.domToModelTransform(t(this.el).val());return this.stripWhitespace&&this.options.stripWhitespace!==!1&&(e=e.replace(/^\s+|\s+$/g,"")),e},set:function(e){t(this.el).val(this.modelToDomTransform(e))},modelToDomTransform:function(e){return void 0!==e||NaN!==e?e:""},domToModelTransform:function(e){return e},bindToModel:function(e){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToModel() called without a modelAttribute";this.modelAttribute=e;var t=this,n=this.model,a="change:"+e;t.form.view.weakBindToModel(a,function(){var a=n.get(e);a!==t.get()&&i.ModelHelpers.isValidAttribute(a)&&t.set(a)}),t.set(n.get(e))},bindToDOM:function(e,n,a){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToDOM() called without a modelAttribute";this.modelAttribute=e;var n=this.options.changeEvent||this.changeEvent||"change";a=a||this.el;var i=this,s=this.model;t(a).bind(n,function(){r(s,e,i.get())}),r(s,e,i.get())}}}),ABINE_DNTME.define("duckbone/validateable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.ValidateableField={isValidateableField:!0,bindValidation:function(e,n){var a=this.options.validate||this.options.required;if(a){var i=this;e=e||this.options.validateEvent||"change",n=n||this.el;var r=t(window),s=null,o=function(){s=new Date},l=function(){r.unbind("mouseup",l),i.validate()};this.form.view&&this.form.view.isBindableView?this.form.view.weakBindTo(r,"mousedown",o):r.bind("mousedown",o),t(n).bind(e,function(){s&&new Date-s<10?r.bind("mouseup",l):i.validate()})}},validate:function(e,t){if(t=t||!1,t||this.clearErrors(),this.valid=!0,!this.options.validate&&this.options.required&&(this.options.validate="required",this.options.invalidMessage=this.options.invalidMessage||"Required"),e=e||this.options.validate,"string"==typeof e&&(e=i.forms.validators[e]),!e)return!0;var n=this.options.invalidMessage||"Invalid";if(0==e.call(this,this.get())&&(this.valid=!1),this.valid||t){var a=this.get();i.ModelHelpers.isValidAttribute(a)&&this.set(a)}else this.addError(n);return this.valid},addError:function(e){if(!this.errorList){this.errorList=t("<ul>").addClass("error");var n=t(this.el).parents("form").find("div."+this.name+"_errors").get(0);n?t(n).append(this.errorList):t(this.el).after(this.errorList)}this.errorList.append(t("<li>").html(e))},clearErrors:function(){this.errorList&&(this.errorList.remove(),this.errorList=null)}}}),ABINE_DNTME.define("duckbone/form_fields",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/intl"],function(e,t,n,a,i,r){a.registerHelper("form",function(e,t){var n=e;return n=n.replace(/^(new_)(.*)/,"$2").replace(/^(edit_)(.*)/,"$2"),n!=e&&(n+=" "+e),'<form action="#" name="'+e+'" class="'+n+'">\n'+t(this)+"\n</form>"}),a.registerHelper("form_error_banner",function(e){return e="string"==typeof e?e:"mm_duckbone_default_form_error",e=r.getText(e),new a.SafeString('<div class="error_banner alert alert-error" style="display: none">'+a.Utils.escapeExpression(e)+"</div>")}),a.registerHelper("form_error",function(e){return new a.SafeString('<div class="'+a.Utils.escapeExpression(e)+'_errors"></div>')}),a.registerHelper("form_label",function(e,t){var n;return"object"==typeof t?(n=e,n=n.replace(/^(.)/,function(e){return e.toUpperCase()}),n=n.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_"," ")})):n="function"==typeof t?new a.SafeString(t(this)):r.getText(t),new a.SafeString('<label data-field-name="'+a.Utils.escapeExpression(e)+'">'+a.Utils.escapeExpression(n)+"</label>")}),a.registerHelper("form_text",function(e){return new a.SafeString('<input class="form_text" type="text" name="'+a.Utils.escapeExpression(e)+'"/>')}),a.registerHelper("form_select",function(e){return new a.SafeString('<select class="form_select" name="'+a.Utils.escapeExpression(e)+'"></select>')}),a.registerHelper("form_radio_set",function(e){return new a.SafeString('<div class="form_radio_set" name="'+a.Utils.escapeExpression(e)+'"></div>')}),a.registerHelper("form_checkbox",function(e){return new a.SafeString('<input class="form_checkbox" type="checkbox" name="'+a.Utils.escapeExpression(e)+'"/>')}),a.registerHelper("form_textarea",function(e){return new a.SafeString('<textarea class="form_textarea" name="'+a.Utils.escapeExpression(e)+'"></textarea>')}),a.registerHelper("form_password",function(e){return new a.SafeString('<input class="form_password" type="password" name="'+a.Utils.escapeExpression(e)+'"></input>')}),a.registerHelper("form_submit",function(e,t){return"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=r.getText(t),new a.SafeString('<button class="form_submit" name="'+a.Utils.escapeExpression(e)+'">'+a.Utils.escapeExpression(t)+"</button>")}),a.registerHelper("form_submit_with_spinner",function(e,t,n){n="object"==typeof n?"/pages/images/ajax_loader.gif":n,"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=r.getText(t);var i='<button class="form_submit" name="'+a.Utils.escapeExpression(e)+'">'+a.Utils.escapeExpression(t)+"</button>";return i+='<img src="'+a.Utils.escapeExpression(n)+'" class="ajax_loading '+a.Utils.escapeExpression(e)+'_loading" style="display: none"/>',new a.SafeString(i)}),i.FormFieldBase=n.View.extend(),e.extend(i.FormFieldBase.prototype,i.BindableField,i.ValidateableField,{initialize:function(e){this.name=this.options.name||t(this.el).attr("name"),this.form=this.options.form,e.elAttributes&&t(this.el).attr(e.elAttributes),this.afterInitialize(e),this.createChildren(),this.bindToModel(),this.bindToDOM(),this.bindValidation()},afterInitialize:function(){},createChildren:function(){}}),i.TextFormField=i.FormFieldBase.extend({type:"text",stripWhitespace:!0}),i.SelectFormField=i.FormFieldBase.extend({type:"select",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var i in n){var r=t("<option></option>").attr({value:i});r.html(a.Utils.escapeExpression(n[i])),t(this.el).append(r)}}}),i.RadioSetFormField=i.FormFieldBase.extend({type:"radio_set",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var i in n){var r=this.form.name+"_"+this.name+"_"+i,s=t('<div><input type="radio"/><label for="'+r+'" class="radio_label"></label></div>');t(s).find("input").attr({id:r,name:this.name,value:i}),t(s).find("label").html(a.Utils.escapeExpression(this.options.selectOptions[i])),t(this.el).append(s)}var o=this.el;t(this.el).find("input").bind("change",function(){t(o).trigger("change")})},get:function(){return t(this.el).find("input:checked").attr("value")},set:function(e){var n=t(this.el).find("input:checked").get(0);n&&(n.checked=!1);var a=t(this.el).find('input[value="'+e+'"]').get(0);a&&(a.checked=!0)}}),i.CheckboxFormField=i.FormFieldBase.extend({type:"checkbox",get:function(){return t(this.el).is(":checked")},set:function(e){t(this.el).attr({checked:e})}}),i.TextAreaFormField=i.FormFieldBase.extend({type:"textarea",stripWhitespace:!0}),i.PasswordFormField=i.FormFieldBase.extend({type:"password"}),i.SubmitFormField=n.View.extend(),e.extend(i.SubmitFormField.prototype,i.BindableField,{type:"submit",initialize:function(n){this.form=n.form,this.name=n.name,this.spinnerEl=t(this.el).next("img.ajax_loading"),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this)),this.submitForm="undefined"==typeof n.submitForm||n.submitForm},bindDisableAndSpin:function(e){e.preventDefault(),this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.form.model.on("sync:create",this.disableAndSpin,this),this.form.model.on("sync:update",this.disableAndSpin,this),this.submitForm&&this.form.submit()},disableAndSpin:function(){this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.spinnerEl&&t(this.spinnerEl).fadeIn(),t(this.el).addClass("loading"),t(this.el).unbind("click"),t(this.el).bind("click",this.stealClick),this.form.model.on("sync:complete",this.syncComplete,this)},stealClick:function(e){return e.preventDefault(),!1},syncComplete:function(){t(this.el).unbind("click"),t(this.el).removeClass("loading"),this.spinnerEl&&t(this.spinnerEl).fadeOut(),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this))}}),i.forms.fieldTypes={text:i.TextFormField,select:i.SelectFormField,radio_set:i.RadioSetFormField,checkbox:i.CheckboxFormField,textarea:i.TextAreaFormField,password:i.PasswordFormField,submit:i.SubmitFormField}}),ABINE_DNTME.define("duckbone/editable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){function r(e,t){for(var n in t){var a=e[t[n]];"function"==typeof a&&e.weakBindToModel(n,a,e)}}function s(e,t){return e.name+"_"+t.name}function o(e){return"[name="+e+"]"}function l(e){var n=/^form_(.*)/.exec(t(e).attr("class"))[1];return i.forms.fieldTypes[n]}function d(e){var n=t(e).offset().top;n=n>p?n-p:0,t("html body").animate({scrollTop:n},u,h)}i.EditableView={isEditableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},createForm:function(e){e=e||{};var a=e.el||t(this.el).find("form").get(0)||t(this.el).get(0),r=e.fields||this.options.fields||this.fields,s=e.model||this.model,o=new i.FormManager({el:a,fields:r,model:s||new n.Model,view:this});return this.form=this.form||o,o},bindModelSyncEvents:function(){r(this,m),this.modelSyncEvents&&r(this,this.modelSyncEvents)},cloneModelForEditing:function(){if(!this.model)throw"Found not, has your model been. Cloned, it can not be.";this.originalModel=this.model,this.model=this.originalModel.clone(),this.weakBindToModel("sync:success",function(){var t=e.clone(this.model.attributes);e(this.form.fields).each(function(e){e.options.temporary&&delete t[e.modelAttribute]}),this.originalModel.set(t),c.call(this)},this)},expireClone:function(){if(this.originalModel){this.model.clear({silent:!0});var e=function(){throw"Attempted get/set on expired clone from Duckbone.EditableView. Use original model instead."};this.model.set=e,this.model.get=e,this.model=this.originalModel,delete this.originalModel}},resetModel:function(){if(!this.originalModel)throw"Cloned not, has your model been. Reset, we can not do.";this.model.set(this.originalModel.attributes)},defaultModelSyncSavingHandler:function(){t(this.el).find("div.error_banner").hide(),e.each(this.form.fields,function(e){e.isValidateableField&&e.clearErrors()},this)},defaultModelSyncInvalidHandler:function(){t(this.el).find("div.error_banner").show(),e.each(this.model.errors,function(t,n){var a=this.form.getFieldForModelAttribute(n);e.each(this.model.errors[n],function(t){a&&a.isValidateableField?a.addError(t):e.log("Cannot add error for field "+n+": "+t)},this)},this),t(this.el).find("div.error_banner").show(),d(this.el)},defaultModelSyncSuccessHandler:function(){},defaultModelSyncErrorHandler:function(){},defaultModelSyncCompleteHandler:function(){}},i.FormManager=function(a){this.el=a.el||t('<form action="#"></form>').get(0),this.fieldOptions=e.clone(a.fields)||{},this.model=a.model||new n.Model({}),this.view=a.view,this.name=t(this.el).attr("name")||"untitled_form",this.createFields()},e.extend(i.FormManager.prototype,n.Events),e.extend(i.FormManager.prototype,{createFields:function(){var e,n,a=this;for(n in this.fieldOptions)e=this.createField(n,this.fieldOptions[n]);t(this.el).find("button.form_submit").each(function(){n=t(this).attr("name"),a.fields[n]||(e=new i.forms.fieldTypes.submit({name:n,el:this,form:a}),a.fields[e.name]=e)}),t(this.el).find("label").each(function(){var e=t(this).attr("data-field-name");e&&a.fields[e]&&t(this).attr("for",s(a,a.fields[e]))})},createField:function(n,a){this.fields=this.fields||{};var r,d,c;if(r=t(this.el).find(o(n)).get(0),!r)throw"Form field "+n+" defined in view, missing in template";if(d=a.type?i.forms.fieldTypes[a.type]:l(r),!d)throw"Bad form field type "+n;return c=new d(e.extend(a,{el:r,model:this.model,form:this,name:n})),c.name=n,t(c.el).attr("id",s(this,c)),this.fields[n]=c,c},getField:function(e){return this.fields[e]},getFieldForModelAttribute:function(t){return e.detect(this.fields,function(e){return e.modelAttribute==t},this)},validate:function(){this.isValid=!0;var e;for(var t in this.fields)e=!this.fields[t].validate||this.fields[t].validate(),e||(this.isValid=!1);return this.isValid},submit:function(n){this.validate()?(n=e.clone(n)||{},e.each(["success","error"],function(t){if("function"==typeof n[t]){var a=n[t];n[t]=function(t,n){e.defer(e.bind(a,t,t,n))}}},this),this.model.save(null,n)):(e.log("Form is invalid."),t(this.el).find("div.error_banner").show(),d(this.el))}});var c=function(){var t=this.options.afterSaveDestination||this.afterSaveDestination;t&&(t instanceof Array||(t=[t]),e.each(t,function(e){if(e.collection)e.collection.add(this.originalModel);else{var t="set"+e.association.slice(0,1).toUpperCase()+e.association.slice(1);e.model[t].call(e.model,this.originalModel)}},this))},m={"sync:create":"defaultModelSyncSavingHandler","sync:update":"defaultModelSyncSavingHandler","sync:success":"defaultModelSyncSuccessHandler","sync:invalid":"defaultModelSyncInvalidHandler","sync:error":"defaultModelSyncErrorHandler","sync:complete":"defaultModelSyncCompleteHandler"},u=400,h="swing",p=100}),ABINE_DNTME.define("duckbone/form_validations",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a,i){i.forms=i.forms||{},i.forms.validators=i.forms.validators||{},e.extend(i.forms.validators,{required:function(e){return!(void 0==e||null==e||""==e)},USPhone:function(e){return/^\(?(\d{3})\)?[\- ]?\d{3}[\- ]?\d{4}$/.test(e)},date:function(e){return/^(?:0?[1-9]|1[0-2])\/(?:0?[1-9]|[12][0-9]|3[01])\/\d{2}?\d{2}$/.test(e)},email:function(e){return/^([A-Za-z0-9\._%\+\-]+)@([A-Za-z0-9\-]+\.)+([A-Za-z]{2,})$/.test(e)},numeric:function(e){return NaN!=parseFloat(e)}})}),ABINE_DNTME.define("duckbone/simple_queue",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,a){a.SimpleQueue=function(e){this.interval=e.interval||400,this.elements=[],this.callback=e.callback,this.running=!1},e.extend(a.SimpleQueue.prototype,{push:function(t){this.elements.push(t),this.comparator&&e(this.elements).sortBy(this.comparator),this.running||(this.running=!0,this.timer=setInterval(e.bind(this.shift,this),this.interval))},shift:function(){if(0==this.elements.length)this.running=!1,clearInterval(this.timer);else{var e=this.elements.shift();this.callback.call(e,e,this)}}})}),ABINE_DNTME.define("duckbone/base_classes",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","jquery","abine/timer"],function(e,t,n,a,i,r){a.Model=t.Model.extend(),a.include(a.Model.prototype,a.AssociableModel,a.ModelHelpers,a.Syncable),a.Collection=t.Collection.extend(),a.include(a.Collection.prototype,a.CollectionHelpers,a.Syncable),a.View=t.View.extend(),a.include(a.View.prototype,a.TemplateableView,a.BindableView),a.View.prototype.transferEvents=function(t,n){e.each(t,e.bind(function(t){"resize"!=t?this.on(t,function(e,a){n.trigger.apply(n,[t,e,a])}):this.on(t,function(a){r.setTimeout(e.bind(function(){n.trigger.apply(n,[t,a])},this),50)})},this))},t.View.prototype.make=function(e,t,n){var a=(this.doc||this.options.doc||document).createElement(e);return t&&i(a).attr(t),n&&i(a).html(n),a},a.FormView=a.View.extend(),a.include(a.FormView.prototype,a.EditableView),a.ListView=t.View.extend(),a.include(a.ListView.prototype,a.ListableView,a.BindableView),a.Application=t.Router.extend(),a.include(a.Application.prototype,a.RouteableApplication,a.FlashableView)}),ABINE_DNTME.define("duckbone/security",["documentcloud/underscore","jquery","duckbone/core"],function(e,t,n){function a(e,t,n){if(!e._unlockHooked){e._unlockHooked=!0;var a=function(){i(e,t,n)};ABINE_DNTME.App.on("unlocked",a),t.prototype._oldBeforeRemove=t.prototype.beforeRemove,t.prototype.beforeRemove=function(){t.prototype.beforeRemove=t.prototype._oldBeforeRemove,t.prototype.beforeRemove&&t.prototype.beforeRemove.apply(e,arguments),e._unlockHooked=!1,ABINE_DNTME.App.off("unlocked",a)}}}function i(e,t,n){return ABINE_DNTME.App.isLocked()?(a(e,t,n),e):void t.prototype._oldRender.apply(e,n)}function r(e,t){ABINE_DNTME.App.isLocked()?ABINE_DNTME.App.renderPage():e._oldRouteAction.apply(e,t)}n.Security={showBlankWhenLocked:function(e){e.prototype._oldRender=e.prototype.render,e.prototype.render=function(){i(this,e,arguments)}},showLoginWhenLocked:function(e){e._oldRouteAction=e.routeAction,e.routeAction=function(){r(e,arguments)}}}}),ABINE_DNTME.requireDuckbone=function(e){ABINE_DNTME.require(["duckbone/core","duckbone/model","duckbone/syncable","duckbone/collection","duckbone/routeable_application","duckbone/view_lifecycle_extensions","duckbone/handlebars_extensions","duckbone/idme_template_registry","duckbone/nestable_view","duckbone/templateable_view","duckbone/stylizeable_view","duckbone/pageable_view","duckbone/pageable_collection","duckbone/bindable_view","duckbone/listable_view","duckbone/flashable_view","duckbone/bindable_field","duckbone/validateable_field","duckbone/form_fields","duckbone/editable_view","duckbone/form_validations","duckbone/simple_queue","duckbone/base_classes"],function(){e()})},ABINE_DNTME.define("models",[],function(){return{}}),ABINE_DNTME.requireModels=function(e){ABINE_DNTME.require(["abine/models/base","abine/models/blacklist","abine/models/disposableCard","abine/models/disposableEmail","abine/models/disposablePhone","abine/models/dntStats","abine/models/preference","abine/models/autofillFeedback","abine/models/mappedForm","abine/models/pageData","abine/models/mappedField","abine/models/mappingMenu","abine/models/shieldedCard","abine/models/shieldedEmail","abine/models/shieldedPhone","abine/models/tabData","abine/models/address","abine/models/account","abine/models/identity","abine/models/realCard","abine/models/globalData","abine/models/feedback","abine/models/trackerInfo","abine/models/advt","abine/models/extensionVersion","abine/models/loginUrl"],function(){
e()})},ABINE_DNTME.define("abine/models/base",["abine/contentMessenger","documentcloud/backbone","duckbone/core","models"],function(e,t,n,a){function i(){return r||(r=ABINE_DNTME.contentMessenger||new e.ContentMessenger({messengerId:"model"})),r}var r,s=function(e,t,n){var a,r,s,o=n.payload||{};!t||"create"!=e&&"update"!=e||(o=t.toJSON(),delete o.messenger),n.eventName?a=n.eventName:(a=t.model?e+":"+t.model.storageEntity:e+":"+t.storageEntity,"create"!=e&&(a+=":"+t.id)),r="response:"+a.split(":").slice(1).join(":"),s="error:"+a.split(":").slice(1).join(":");var l=t.messenger;!l&&t.collection&&t.collection.messenger&&(l=t.collection.messenger),l||(l=i());var d=function(e){l.off(r,d),l.off(s,c),delete t.errors,n.success.call(t,e,200,null),t.trigger("sync:success",e)},c=function(e){l.off(s,c),l.off(r,d),delete t.errors,n.error.call(t,e,500,null),t.trigger("sync:error",e)};l.on(r,d,t),l.on(s,c,t),t.trigger("sync:"+e.toLowerCase()),l.send(a,o)},o=function(e){var t=this.get(e);return"1"===t||"true"===t||t===!0||1===t},l=function(e){return!o(e)},d=t.Model.extend({sync:s,getMessenger:i,isTrue:o,isFalse:l});n.include(d.prototype,n.AssociableModel,n.ModelHelpers);var c=t.Collection.extend({sync:s,getMessenger:i,fetchAll:function(e){e=e||{},e.eventName=["read",this.model.prototype.storageEntity,"all"].join(":"),this.fetch(e)}});return n.include(c.prototype,n.CollectionHelpers),a.BaseModel=d,a.BaseCollection=c,{BaseModel:d,BaseCollection:c}}),ABINE_DNTME.define("abine/models/blacklist",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"blacklist",initialize:function(){this.messenger=this.getMessenger()},getDomain:function(){return this.get("domain")},getId:function(){return this.get("id")},fetchByDomain:function(e,t){var n=this,a=e?"create":"read",i=this.get("domain");i&&(i=i.replace(":","::"));var r=a+":blacklist:domain:"+i;this.sync(a,this,{eventName:r,success:function(e){n.set(e),t(null)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/site]#[loadAccounts]# error event in model.sync eventName: create/read:blacklist:domain:domain"),t("No blacklist")}})},emailEnabled:function(){return this.get("globalEmail")&&!this.get("email")},phoneEnabled:function(){return this.get("globalPhone")&&this.get("premium")&&!this.get("phone")},cardEnabled:function(){return this.get("globalCard")&&this.get("hasEnabledCard")&&!this.get("card")},accountsEnabled:function(){return this.get("hasEnabledAccounts")},passwordsEnabled:function(){return this.get("globalPassword")&&!this.get("password")},loginsEnabled:function(){return this.get("globalLogin")&&!this.get("login")}}),a=t.BaseCollection.extend({model:n});return t.Blacklist=n,t.BlacklistCollection=a,{Blacklist:n,BlacklistCollection:a}}),ABINE_DNTME.define("abine/models/disposableCard",["models","abine/eventLogger"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableCard",initialize:function(){},isGift:function(){return this.isTrue("gift")},getCreatedDate:function(){var e=this.get("createdAt").substring(0,10).split("-");return e[1]+"/"+e[2]+"/"+e[0]},isOldMaskedCard:function(){return"old_masked_card"==this.get("cardType")},getBrand:function(){return this.get("brand").toLowerCase()},isCompany:function(){return this.isTrue("company")},getRecipientEmail:function(){return this.get("recipient_email")},getTotalFee:function(){return this.get("total_fee")},isActive:function(){return this.isTrue("active")},getID:function(){return this.id},getGUID:function(){return this.get("guid")},getAmountRefunded:function(){return"$"+(this.get("amount_refunded")/100).toFixed(2)},getOriginalValue:function(){return"$"+(this.get("original_amount")/100).toFixed(2)},getTotalCharge:function(){return"$"+((this.get("original_amount")+this.get("total_fee"))/100).toFixed(2)},isAch:function(){return this.get("payment_source")&&("checking"==this.get("payment_source")||"savings"==this.get("payment_source"))},getCardDetails:function(){return this.getCardNumber()+" - "+this.getExpiry()},getLastFour:function(){return this.get("number").substr(this.get("number").length-4)},getCardNumber:function(){return this.get("number")},getSeparatedCardNumber:function(){var e=this.get("number");return 16==e.length?e.substring(0,4)+" "+e.substring(4,8)+" "+e.substring(8,12)+" "+e.substring(12,16):e},getSeparatedMaskedCardNumber:function(){var e=this.get("number");if(16==e.length)return Array(4).join("**** ")+e.substring(12,16);var t=this.get("type");return t&&t.match(/amex|american/i)?"**** ****** *"+e.substr(-4):Array(e.length-3).join("*")+e.substr(-4)},getMaskedVerification:function(){return Array(this.get("cvc").length+1).join("*")},getMaskedExpiry:function(){return this.getExpiry().replace(/[0-9]/g,"*")},getType:function(){return this.get("type").toLowerCase()},getPrettyNumber:function(){for(var e="",t=0;t<this.get("number").length;t++)e+=this.get("number").charAt(t),t%4==3&&(e+="  ");return e},getCVC:function(){return this.get("cvc")},getExpiry:function(){var e=parseInt(this.get("expiry_month"));return e<10&&(e="0"+e),e+"/"+this.get("expiry_year")},getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getDomain:function(){var e=this.get("domain");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getProtectedNumber:function(){var e=this.get("number")+"";return e.substr(0,e.length-12).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})}});n.convertStringToCents=function(e){return parseFloat(e).toFixed(2).toString().replace(".","")};var a=e.BaseCollection.extend({model:n,fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableCard:site:"+e,success:function(e){this.reset(e)},error:function(){t.error("[ERROR HANDLER][abine/models/disposableCard][fetchAllBySite]: error event in model.sync event: read:disposableCard:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableCard:server",success:function(t){this.reset(t),e.success(t)},error:function(){e.error(),ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableCard:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableCard:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableCard:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableCard=n,e.DisposableCardCollection=a,{DisposableCard:n,DisposableCardCollection:a}}),ABINE_DNTME.define("abine/models/disposableEmail",["models","documentcloud/underscore"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableEmail",highlighted:!1,initialize:function(){this.hasOne({account:{model:e.Account}})},getId:function(){return this.get("id")},hasWebmail:function(){return!!(this.has("webmails")&&this.get("webmails").length>0)},getWebmailCount:function(){return this.hasWebmail()?this.get("webmails").length:0},hasAccount:function(){return!!(this.has("accountId")&&""!=this.get("accountId")&&this.account&&this.account.accountFields)&&t.any(this.account.accountFields.models,function(e){return e.get("value")==this.getAddress()},this)},getAddress:function(){return this.get("user")+"@"+this.get("domain")},getHighlightedClass:function(){return this.get("highlighted")?"highlighted":""},noConnectionError:function(){return!this.get("err")},isActive:function(){return 1==this.get("active")},toggleDisposable:function(e){this.save({active:1==this.get("active")?0:1},e)},needsTruncation:function(){var e=this.getDomain();return e.length>20},getTruncatedDomain:function(){var e=this.getDomain();return e.substring(0,20)+"..."},getDomain:function(){return this.attributes.label?this.attributes.label:"Unknown"}}),a=e.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:saveForm:(new|update)/i,initialize:function(){this.messenger=this.getMessenger()},totalWebmails:function(){return t.reduce(this.models,function(e,t){return e+t.getWebmailCount()},0)},countUserCreated:function(){return t.reduce(this.models,function(e,t){return"abine.com"!=t.getDomain()?e+1:e},0)},fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableEmail:site:"+e,success:function(e){this.reset(e)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllBySite]# error event in model.sync eventName: read:disposableEmail:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableEmail:server",success:function(t){this.reset(t),e()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableEmail:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableEmail:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableEmail:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableEmail=n,e.DisposableEmailCollection=a,{DisposableEmail:n,DisposableEmailCollection:a}}),ABINE_DNTME.define("abine/models/disposablePhone",["models"],function(e){var t=e.BaseModel.extend({storageEntity:"disposablePhone",initialize:function(){this.hasOne({account:{model:e.Account}})},getCountryCode:function(){return this.get("country_code")||"1"},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){return this.isNorthAmericaFormat()?"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():this.get("number")},getFullPrettyNumber:function(){return this.isNorthAmericaFormat()?"+"+this.getCountryCode()+" ("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():"+"+this.getCountryCode()+" "+this.get("number")},getFormattedText:function(){return this.getFullPrettyNumber()},isNorthAmericaFormat:function(){return"1"==this.getCountryCode()},isSuspended:function(){return"true"==this.get("isSuspended")},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})},toFillData:function(){var e,t=this.toJSON(),n=t.country_code,a=t.number,i="",r="",s="",o="";return"1"==n?(i=a.substring(0,3),s=a.substring(3,6),o=a.substring(6,10),r=s+"-"+o,e="+1 ("+i+") "+s+"-"+o):(r="+"+n+a,e="+"+n+" "+a),t.label=e,t.area=i,t.exchange=s,t.local=o,t.last7=r,t}}),n=e.BaseCollection.extend({model:t,fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposablePhone:site:"+e,success:function(e){this.reset(e)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposablePhone]#[fetchAllBySite]# error event in model.sync event: read:disposablePhone:site:id")}})}});return e.DisposablePhone=t,e.DisposablePhoneCollection=n,{DisposablePhone:t,DisposablePhoneCollection:n}}),ABINE_DNTME.define("abine/models/dntStats",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,a){function i(e){e+="";for(var t=e.split("."),n=t[0],a=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;i.test(n);)n=n.replace(i,"$1,$2");return n+a}var r=t.BaseModel.extend({storageEntity:"dntStats",initialize:function(){this.messenger=this.getMessenger()},addCommas:function(e){e+="";for(var t=e.split("."),n=t[0],a=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;i.test(n);)n=n.replace(i,"$1,$2");return n+a},showMedals:function(){return this.get("showMedals")},viewedBadge:function(){return this.get("viewedBadge")},canAutoShowBadge:function(){if(this.get("viewedBadge")||!this.get("showMedals"))return!1;var e=this.get("earnedOn");return!e||Date.now()-e<2592e5},toggleViewedBadge:function(){this.save({viewedBadge:!this.get("viewedBadge")})},achievedBronze:function(){return this.get("currentBadgeIndex")>-1},achievedSilver:function(){return this.get("currentBadgeIndex")>0},achievedGold:function(){return this.get("currentBadgeIndex")>1},achievedPlatinum:function(){return this.get("currentBadgeIndex")>2},getPlatinumCount:function(){return this.achievedPlatinum()?"x"+(this.get("currentBadgeIndex")-2):"X"},nextMedalAtFormatted:function(){return this.addCommas(this.nextMedalAt())},nextMedalAt:function(){return this.achievedPlatinum()?this.platinumLimit*(this.get("currentBadgeIndex")-1)-this.get("totalAllTimeTrackers"):this.achievedGold()?this.platinumLimit-this.get("totalAllTimeTrackers"):this.achievedSilver()?this.goldLimit-this.get("totalAllTimeTrackers"):this.achievedBronze()?this.silverLimit-this.get("totalAllTimeTrackers"):this.bronzeLimit-this.get("totalAllTimeTrackers")},getFunword:function(){var e=this.get("totalAllTimeTrackers");return e<=100?a.getText("mm_dntme_funword1"):e<=1e3?a.getText("mm_dntme_funword2"):e<=1e4?a.getText("mm_dntme_funword3"):a.getText("mm_dntme_funword4")},getBadgeCount:function(){var e=JSON.parse(this.get("currentBadge"));return this.addCommas(e.limit)},getBadgeType:function(){var e=JSON.parse(this.get("currentBadge"));return e.cssClass},getAllTimeTotalTrackers:function(){return this.get("totalAllTimeTrackers")},formattedTotal:function(){return i(this.get("totalAllTimeTrackers")+"")},totalGreaterThan10000:function(){return this.get("totalAllTimeTrackers")>1e4},totalGreaterThan1000000:function(){return this.get("totalAllTimeTrackers")>1e6},getDailyTotalsByYear:function(e){var t=JSON.parse(this.get("dailyTrackerCounts"));return e in t?t[e]:{}},getBadTrackerDataByYear:function(e){var t=JSON.parse(this.get("badTrackers"));if(!t.totals)return{};var n=t.totals,a={},i=[e,e-1];for(var r in n)for(var s=0;s<i.length;s++){var o=r+"."+i[s];t.daily&&o in t.daily&&(a[r]={},a[r][i[s]]=t.daily[o])}var l={};return{totals:n,daily:a,links:l}}});return t.DntStats=r,{DntStats:r}}),ABINE_DNTME.define("abine/models/preference",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"preference",initialize:function(){},parse:function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e},toJSON:function(){var t=e.clone(this.attributes);return t.value===!0?t.value="true":t.value===!1&&(t.value="false"),t}}),a=t.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:preference:reload/i,parse:function(t){return e(t).map(function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e})},restoreDefaults:function(t){this.sync("update",this,{eventName:"update:preference:restore",success:e.bind(function(e){this.reset(this.parse(e)),t()},this),error:function(e){t(e)}})},getPrefFromStorage:function(t,a){this.sync("read",this,{eventName:"read:preference:name:"+t,success:function(t){a(e.isArray(t)&&0===t.length?null:e.isObject(t)?new n(t):null)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/preference]#[getPrefFromStorage]# error event in model.sync eventName: read:preference:name:key"),a(null)}})},isPrefTrue:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return!!n&&n.isTrue("value")},getPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return n?n.get("value"):null},isMapper:function(){return!0},setPref:function(n,a){var i=e(this.models).find(function(e){return e.get("key")===n});i?i.save({value:a}):(i=new t.Preference,i.save({key:n,value:a}),this.add(i))},removePref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});n&&(n.destroy(),this.remove(n))},hasPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return!!n},getSplitTest:function(e){var t=this.getPref("splitTests")||{};try{t=JSON.parse(t)}catch(e){}return t[e]||"default"}});return t.Preference=n,t.PreferenceCollection=a,{Preference:n,PreferenceCollection:a}}),ABINE_DNTME.define("abine/models/loginUrl",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"loginUrl"}),a=t.BaseCollection.extend({model:n,initialize:function(){},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:loginUrl:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/loginUrl]#[fetchAllByDomain]# error event in read:loginUrl:site:domain"),t(!0)}})}});return t.LoginUrl=n,t.LoginUrlCollection=a,{LoginUrl:n,LoginUrlCollection:a}}),ABINE_DNTME.define("abine/models/extensionVersion",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"extensionVersion",initialize:function(){this.messenger=this.getMessenger()}});return t.ExtensionVersion=n,{ExtensionVersion:n}}),ABINE_DNTME.define("abine/models/autofillFeedback",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"autofillFeedback"});return t.AutofillFeedback=n,{AutofillFeedback:n}}),ABINE_DNTME.define("abine/models/mappedForm",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedForm",initialize:function(){this.hasMany({fields:{collection:t.MappedFieldCollection}})},searchSignature:function(t){this.sync("read",this,{eventName:"read:mappedForm:signature:"+this.get("signature"),success:e.bind(function(e){e?(this.set(e),t()):t(!0)},this),error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[searchSignature]# error event in searchSignature"),t(!0)}})}}),a=t.BaseCollection.extend({model:n,initialize:function(e){this.messenger=e.messenger},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:mappedForm:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[fetchAllByDomain]# error event in read:mappedForm:site:domain"),t(!0)}})},fetchLocalAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:mappedForm:local:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[fetchAllByDomain]# error event in read:mappedForm:site:domain"),t(!0)}})}});return t.MappedForm=n,t.MappedFormCollection=a,{MappedForm:n,MappedFormCollection:a}}),ABINE_DNTME.define("abine/models/mappedField",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedField",initialize:function(){}}),a=t.BaseCollection.extend({model:n,initialize:function(){}});return t.MappedField=n,t.MappedFieldCollection=a,{MappedField:n,MappedFieldCollection:a}}),ABINE_DNTME.define("abine/models/mappingMenu",["documentcloud/underscore","models"],function(e,t){function n(e){if(e.children)for(var t=0;t<e.children.length;t++)n(e.children[t]);else if(e.type){if(_[e.type])return;var a;if(a=e.label?e.label:e.name,a=a.replace(/\([^\)]+\)/g,"").replace(/^[\s]+|[\s]+$/g,""),a.indexOf("{")!=-1)return;_[e.type]=a}}function a(e){if(null==_){_={};for(var t in p)p[t].length>=0||n(p[t])}return _[e]||"Unknown"}function i(e){if(null==e)return"Other";var t={loginForm:"Login",registrationForm:"Register",checkoutForm:"Checkout",addressForm:"Address",changePasswordForm:"Change Password"};return e in t?t[e]:"Other"}function r(e,t,n,a,i){var r=[];if(!i)return r;var s={};for(var o in t)s[o]=t[o];for(var l=0,o=0;o<i.length;o++){var m=i.at(o),u=m.toFillData(),h={};c(t,n,u,h),h.label.indexOf("{")==-1&&(d(t,n,h),h.path=e+"."+a+"."+l,h.hasChildren=!0,r.push(new w(h)),l++)}return r}function s(e,t,n,a,i,r){var s={},o=i.toFillData();return c(t,n,o,s),s.label.indexOf("{")!=-1?null:(s.path=e+"."+a+"."+r,n.children&&(s.hasChildren=!0),d(t,n,s),l(n,s),null!=s.value&&(s.value=h(o,s.value),s.value.indexOf("{")!=-1)?null:new w(s))}function o(e,t,n,a,i){var r={};return r.label=h(n,a.name),r.label.indexOf("{")!=-1&&a.alternate_name&&(r.label=h(n,a.alternate_name)),r.label.indexOf("{")!=-1?null:(r.path=e+"."+i,d(n,a,r),a.children?r.hasChildren=!0:(l(a,r),t&&r.label.indexOf("never show auto-fill here")!=-1&&(r.label="Auto-fill disabled here, please enable.<br/>(show auto-fill here)",r.action="show_here")),new w(r))}function l(e,t){e.action&&(t.action=e.action),e.type&&(t.type=e.type),e.formType&&(t.formType=e.formType),e.value&&(t.value=e.value)}function d(e,t,n){t.panel_title&&(n.panelTitle=h(e,t.panel_title),n.panelTitle.indexOf("{")!=-1&&(n.panelTitle=n.panelTitle.replace(/\{[^\}]+\}/g,"Unknown")))}function c(e,t,n,a){a.label=h(e,t.name),a.label=h(n,a.label),a.label.indexOf("{")!=-1&&t.alternate_name&&(a.label=h(e,t.alternate_name),a.label=h(n,a.label))}function m(e,t){if(e.match(f))return"Address";if(e.match(g))return"Name";if(e.match(b))return"Card";if(e.match(y))return"Phone";if(e.match(v)){if("loginForm"==t)return"Login";if("registrationForm"==t)return"Register"}return null}function u(e,t){if(t.ref){var n=null;t.name&&(n=t.name),t=e[t.ref],null!=n&&(t.name=n)}return t}function h(e,t){for(var n in e)if(e[n]){if(n.indexOf("{")==-1)var a="{"+n+"}";else var a=n;var a=a.replace(/[\{\}]/g,"\\$&");t=t.replace(new RegExp(a,"g"),e[n])}return t}var p={loginForm:["dont_show","fill_logins","correct_login","mapping","list_accounts","list_emails","list_phones","report"],registrationForm:["dont_show","register","login_on_register","mapping","list_emails","list_phones","report"],checkoutForm:["dont_show","wallet","mapping","list_cards","list_emails","list_phones","report"],identityForm:["dont_show","identity","mapping","list_identities","list_emails","list_phones","list_phones","report"],addressForm:["dont_show","address","mapping","list_addresses","list_emails","list_phones","report"],phoneForm:["dont_show","phone","mapping","list_phones","report"],otherForm:["dont_show","mapping","report"],mapping:{id:"mapping",name:"Fill something different than {data_type}",alternate_name:"Fill unknown field with",children:[{ref:"register",name:"Fill Email, Username, or Password"},{ref:"wallet",name:"Fill Credit Cards or Masked Cards"},{ref:"address",name:"Fill Addresses"},{ref:"phone",name:"Fill Phones"},{ref:"others"}]},more:{id:"more",name:"More",action:"show_more"},report:{id:"report",name:"Report a problem (improve Blur) >",action:"report_problem"},dont_show_extension:{id:"dont_show",name:"Don't show again here",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"dont_show_here"},dont_show:{id:"dont_show",name:"Don't show again here?",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",children:[{id:"field",name:"Don't show again on this field",action:"dont_show_on_field"},{id:"form",name:"Don't show again on this form",action:"dont_show_on_form"},{id:"site",name:"Don't show again on this {app}",action:"dont_show_on_site"}]},fill_logins:{id:"accounts",name:"Fill existing account info",when:"account_has_data",children:[{id:"{account}",name:"{label}",panel_title:"Select existing account info to fill",entities:"account",children:[{id:"{email}",name:"{email}",label:"Email",entity:"account",action:"fill",type:"/contact/email",formType:"loginForm"},{id:"{username}",name:"{username}",label:"Username",entity:"account",action:"fill",type:"/nameperson/friendly",formType:"loginForm"},{id:"{password}",name:"Password for {label}",label:"Password",entity:"account",value:"{password}",action:"fill",type:"/password",formType:"loginForm"}]}]},correct_login:{id:"correct",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"email",name:"Email",type:"/contact/email",formType:"loginForm"},{id:"username",name:"Username",type:"/nameperson/friendly",formType:"loginForm"},{id:"password",name:"Password",type:"/password",formType:"loginForm"},{id:"otp",name:"One Time Password",type:"/auth/otp"}]},list_accounts:{id:"list_accounts",name:"Add/Edit My Accounts",action:"show_list_accounts"},list_emails:{id:"list_emails",name:"Add/Edit My Emails",forType:"email",action:"show_list_identities"},list_phones:{id:"list_phones",name:"Add/Edit My Phones",forType:"phone",action:"show_list_identities"},list_cards:{id:"list_cards",name:"Add/Edit My Cards",action:"show_list_cards"},list_addresses:{id:"list_addresses",name:"Add/Edit My Addresses",action:"show_list_addresses"},list_identities:{id:"list_identities",name:"Add/Edit My Identities",action:"show_list_identities"},register:{id:"register",name:"Correct how the <b>{data_type}</b> is filled",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",children:[{id:"mask_email",name:"Fill New Masked Email",label:"Email",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"mask_email",type:"/contact/email"},{id:"real_email",name:"Fill My Email ({email})",action:"real_email"},{id:"password1",name:"Fill New Strong Password",type:"/password/differentSpecialChars",action:"strong_password"},{id:"security",name:"Fill New Custom Password",label:"Password",children:[{id:"password2",name:"Limited special chars (.-_)",label:"Password with limited special chars",type:"/password/differentSpecialChars",action:"strong_password"},{id:"password3",name:"No special characters",label:"Password without special",type:"/password/noSpecialChars",action:"strong_password"},{id:"password4",name:"No numbers",label:"Password without numbers",type:"/password/noNumbers",action:"strong_password"}]},{id:"username",name:"Fill Username",label:"Username",type:"/nameperson/friendly"}]},login_on_register:{id:"login",name:"Login fields on register form",children:[{id:"loginemail",name:"Login Username or Email",panel_title:"Fill <u>email/password</u> Login info on this combined form",type:"/contact/email/login"},{id:"loginpassword",name:"Login Password",type:"/password/login"}]},wallet:{id:"cards",name:"Correct how the <b>{data_type}</b> is filled",when:"card_has_data",children:[{id:"mask",name:"Fill Masked Card",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"mask_card"},{id:"{card}",name:"Fill {label} (x{last_4})",page_title:"Select existing card info to fill",entities:"card",children:[{id:"number",name:"Fill Card # - <small>x{last_4}</small>",page_title:"Fill {label} (x{last_4})",entity:"card",children:[{id:"number",name:"Fill Card # - <small>x{last_4}</small>",label:"Card Number",page_title:"Fill Full Card #",entity:"card",value:"{number}",action:"fill",type:"/financial/creditcard/number"},{id:"part1",name:"Fill Card # - first 4",label:"Card Number Part 1",entity:"card",value:"{first_4}",action:"fill",type:"/financial/creditcard/part1"},{id:"part2",name:"Fill Card # - second 4",label:"Card Number Part 2",entity:"card",value:"{second_4}",action:"fill",type:"/financial/creditcard/part2"},{id:"part3",name:"Fill Card # - third 4",label:"Card Number Part 3",entity:"card",value:"{third_4}",action:"fill",type:"/financial/creditcard/part3"},{id:"part4",name:"Fill Card # - last 4",label:"Card Number Part 4",entity:"card",value:"{last_4}",action:"fill",type:"/financial/creditcard/part4"},{id:"amex1",name:"Fill Card # - first 4",label:"Amex Number Part 1",entity:"card",value:"{amex_4}",type:"/financial/creditcard/amex/part1"},{id:"amex2",name:"Fill Card # - second 6",label:"Amex Number Part 2",entity:"card",value:"{amex_6}",type:"/financial/creditcard/amex/part2"},{id:"amex3",name:"Fill Card # - last 4",label:"Amex Number Part 3",entity:"card",value:"{amex_5}",type:"/financial/creditcard/amex/part3"}]},{id:"holder_name",name:"Card holder name - <small>{full_name}</small>",entity:"card",children:[{id:"issued",name:"Full Name - <small>{full_name}</small>",label:"Card Holder Name",value:"{full_name}",page_title:"Fill {label} (x{last_4})",entity:"card",action:"fill",type:"/financial/creditcard/issuedto"},{id:"first",name:"First Name - <small>{first_name}</small>",label:"Card Holder First Name",value:"{first_name}",entity:"card",action:"fill",type:"/financial/creditcard/issuedto/first"},{id:"last",name:"Last Name - <small>{last_name}</small>",label:"Card Holder Last Name",value:"{last_name}",entity:"card",action:"fill",type:"/financial/creditcard/issuedto/last"}]},{id:"cvv",name:"Fill CVV/CVC/CVV2",label:"CVV/CVC/CVV2",value:"{cvc}",entity:"card",action:"fill",type:"/financial/creditcard/verification"},{id:"expiry",name:"Fill Expiry Date - <small>{expiry}</small>",label:"Card Expiry (mm/yyyy)",value:"{expiry}",entity:"card",action:"fill",type:"/financial/creditcard/expiry"},{id:"expiry2",name:"Fill Expiry Date - <small>{expiry2}</small>",label:"Card Expiry (mm/yy)",value:"{expiry2}",entity:"card",action:"fill",type:"/financial/creditcard/expiry2"},{id:"month",name:"Fill Expiry month - <small>{expiry_month}</small>",label:"Card Expiry Month",value:"{expiry_month}",entity:"card",action:"fill",type:"/financial/creditcard/expirymonth"},{id:"year",name:"Fill Expiry year - <small>{expiry_year}</small>",label:"Card Expiry Year (yyyy)",value:"{expiry_year}",entity:"card",action:"fill",type:"/financial/creditcard/expiryyear"},{id:"year2",name:"Fill Expiry year - <small>{expiry_year2}</small>",label:"Card Expiry Year (yy)",value:"{expiry_year2}",entity:"card",action:"fill",type:"/financial/creditcard/expiryyear2"},{id:"type",name:"Fill Card type - <small>{type}</small>",label:"Card Type",value:"{type}",entity:"card",action:"fill",type:"/financial/creditcard/type"},{id:"address",name:"Fill Card Billing Address - <small>{address1}</small>",entity:"card",children:[{id:"address1",name:"Fill Address Line 1 - <small>{address1}</small> ",label:"Address Line 1",value:"{address1}",entity:"card",action:"fill",type:"/contact/postaladdress/billing"},{id:"address2",name:"Fill Address Line 2 - <small>{address2}</small>",label:"Address Line 2",value:"{address2}",entity:"card",action:"fill",type:"/contact/postaladdressAdditional/billing"},{id:"address3",name:"Fill Address Line 3 - <small>{address3}</small>",label:"Address Line 3",value:"{address3}",entity:"card",action:"fill",type:"/contact/postaladdress3/billing"},{id:"city",name:"Fill City - <small>{city}</small>",label:"City",value:"{city}",entity:"card",action:"fill",type:"/contact/city/billing"},{id:"state",name:"Fill State - <small>{state}</small>",label:"State",value:"{state}",action:"fill",entity:"card",type:"/contact/state/billing"},{id:"statecode",name:"Fill State Code - <small>{state}</small>",label:"State Code",value:"{state}",entity:"card",action:"fill",type:"/contact/state/code/billing"},{id:"country",name:"Fill Country - <small>{country}</small>",label:"Country",value:"{country}",entity:"card",action:"fill",type:"/contact/country/billing"},{id:"zip",name:"Fill Zip/Postal Code - <small>{zip}</small>",label:"Zip/Postal Code",entity:"card",value:"{zip}",action:"fill",type:"/contact/postalcode/billing"},{id:"zip+",name:"Fill Zip+4 - <small>{zip4}</small>",label:"Zip+4",entity:"card",value:"{zip4}",action:"fill",type:"/contact/zip4/billing"}]}]},{ref:"list_cards"}]},identity:{id:"identity",name:"Correct how the <b>{data_type}</b> is filled",when:"identity_has_data",children:[{id:"{identity}",name:"Fill {label} - <small>{full_name}</small>",page_title:"Select existing identity info to fill",entities:"identity",children:[{id:"full",name:"Full Name - <small>{full_name}</small>",label:"Full Name",value:"{full_name}",entity:"identity",action:"fill",type:"/nameperson/full"},{id:"first",name:"Fill First name - <small>{first_name}</small>",label:"First Name",value:"{first_name}",entity:"identity",action:"fill",type:"/nameperson/first"},{id:"middle",name:"Fill Middle name - <small>{middle_name}</small>",label:"Middle Name",value:"{middle_name}",entity:"identity",action:"fill",type:"/nameperson/middle"},{id:"last",name:"Fill Last name - <small>{last_name}</small>",label:"Last Name",value:"{last_name}",entity:"identity",action:"fill",type:"/nameperson/last"},{id:"email",name:"Fill Email - <small>{real_email}</small>",value:"{real_email}",entity:"identity",action:"fill",type:"/contact/email"},{id:"username",name:"Fill Username - <small>{username}</small>",label:"Username",value:"{username}",entity:"identity",action:"fill",
type:"/nameperson/friendly"},{id:"dob",name:"Date of birth - <small>{dob_month}/{dob_day}/{dob_year}</small>",entity:"identity",children:[{id:"month",name:"Birth month - <small>{dob_month}</small>",label:"Birth month",value:"{dob_month}",entity:"identity",action:"fill",type:"/birthdate/birthmonth"},{id:"day",name:"Birth day - <small>{dob_day}</small>",label:"Birth day",value:"{dob_day}",entity:"identity",action:"fill",type:"/birthdate/birthday"},{id:"year",name:"Birth year - <small>{dob_year}</small>",label:"Birth year",value:"{dob_year}",entity:"identity",action:"fill",type:"/birthdate/birthyear"},{id:"mmddyyyy1",name:"Birth Date - <small>{dob_month}-{dob_day}-{dob_year}</small>",label:"Birth Date",value:"{dob_month}-{dob_day}-{dob_year}",entity:"identity",action:"fill",type:"/birthdate/MM-DD-YYYY"},{id:"mmddyyyy2",name:"Birth Date - <small>{dob_month}/{dob_day}/{dob_year}</small>",label:"Birth Date",value:"{dob_month}/{dob_day}/{dob_year}",entity:"identity",action:"fill",type:"/birthdate/MM/DD/YYYY"},{id:"ddmmyyyy1",name:"Birth Date - <small>{dob_day}-{dob_month}-{dob_year}</small>",label:"Birth Date",value:"{dob_day}-{dob_month}-{dob_year}",entity:"identity",action:"fill",type:"/birthdate/DD-MM-YYYY"},{id:"ddmmyyyy2",name:"Birth Date - <small>{dob_day}/{dob_month}/{dob_year}</small>",label:"Birth Date",value:"{dob_day}/{dob_month}/{dob_year}",entity:"identity",action:"fill",type:"/birthdate/DD/MM/YYYY"}]},{id:"company",name:"Fill Company - <small>{company}</small>",value:"{company}",entity:"identity",action:"fill",type:"/company/name"},{id:"position",name:"Company Position",value:"{designation}",entity:"identity",action:"fill",type:"/company/position"},{id:"website",name:"Website Url",value:"{url}",entity:"identity",action:"fill",type:"/website"},{id:"ssn",name:"SSN #",value:"{ssn}",entity:"identity",action:"fill",type:"/socialSecurityNumber"},{id:"dl",name:"Driver License",value:"{driver_license}",entity:"identity",action:"fill",type:"/driverLicense"}]},{ref:"list_identities"}]},address:{id:"address",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"{address}",name:"Fill {label} - <small>{address1}</small>",page_title:"Select existing address info to fill",entities:"address",children:[{id:"address1",name:"Fill Address Line 1 - <small>{address1}</small> ",page_title:"Fill Address - <small>{address1}</small>",value:"{address1}",entity:"address",action:"fill",type:"/contact/postaladdress"},{id:"address2",name:"Fill Address Line 2 - <small>{address2}</small>",value:"{address2}",entity:"address",action:"fill",type:"/contact/postaladdressAdditional"},{id:"address3",name:"Fill Address Line 3 - <small>{address3}</small>",value:"{address3}",entity:"address",action:"fill",type:"/contact/postaladdress3"},{id:"city",name:"Fill City - <small>{city}</small>",value:"{city}",entity:"address",action:"fill",type:"/contact/city"},{id:"state",name:"Fill State - <small>{state}</small>",value:"{state}",action:"fill",entity:"address",type:"/contact/state"},{id:"statecode",name:"Fill State Code - <small>{state}</small>",value:"{state}",entity:"address",action:"fill",type:"/contact/state/code"},{id:"country",name:"Fill Country - <small>{country}</small>",value:"{country}",entity:"address",action:"fill",type:"/contact/country"},{id:"zip",name:"Fill Zip/Postal Code - <small>{zip}</small>",label:"Zip/Postal Code",entity:"address",value:"{zip}",action:"fill",type:"/contact/postalcode"},{id:"zip+",name:"Fill Zip+4 - <small>{zip4}</small>",label:"Zip+4",entity:"address",value:"{zip4}",action:"fill",type:"/contact/zip4"}]},{id:"mask_address",name:"Fill Masked Card Address - <small>280 Summer St</small>",children:[{id:"address1",name:"Fill Address Line 1 - <small>280 Summer St</small> ",label:"Address Line 1",page_title:"Fill Masked Card Address - <small>280 Summer St, 02210</small>",value:"280 Summer St",action:"fill",type:"/contact/postaladdress"},{id:"city",name:"Fill City - <small>Boston</small>",label:"City",value:"Boston",action:"fill",type:"/contact/city"},{id:"state",name:"Fill State - <small>MA</small>",label:"State",value:"MA",action:"fill",type:"/contact/state"},{id:"country",name:"Fill Country - <small>US</small>",label:"Country",value:"US",action:"fill",type:"/contact/country"},{id:"zip",name:"Fill Zip/Postal Code - <small>02210</small>",label:"Zip/Postal Code",value:"02210",action:"fill",type:"/contact/postalcode"}]},{ref:"list_addresses"}]},phone:{id:"phone",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"{phone}",name:"{label}",page_title:"Select existing phone info to fill",entities:"phone",children:[{id:"full",name:"Phone - <small>{number}</small>",label:"Phone Number (xxx-yyy-zzzz)",entity:"phone",value:"{number}",action:"fill",type:"/contact/phone"},{id:"area",name:"Phone areacode - <small>{area}</small>",label:"Phone Areacode (xxx)",entity:"phone",value:"{area}",action:"fill",type:"/contact/phone/areacode"},{id:"exchange",name:"Phone exchange - <small>{exchange}</small>",label:"Phone Exchange (yyy)",entity:"phone",value:"{exchange}",action:"fill",type:"/contact/phone/exchange"},{id:"local",name:"Phone local - <small>{local}</small>",label:"Phone Local (zzzz)",entity:"phone",value:"{local}",action:"fill",type:"/contact/phone/local"},{id:"number",name:"Phone last 7 - <small>{last7}</small>",label:"Phone Last 7 (yyy-zzzz)",entity:"phone",value:"{last7}",action:"fill",type:"/contact/phone/number"},{id:"country",name:"Phone country code - <small>{country_code}</small>",label:"Phone Country Code",entity:"phone",value:"{country_code}",action:"fill",type:"/contact/phone/countrycode"},{id:"ext",name:"Phone extension",label:"Phone Extension",entity:"phone",value:"{ext}",action:"fill",type:"/contact/phone/extension"}]},{id:"list",name:"Add/Edit My Phones",action:"show_list_identities"}]},others:{id:"others",name:"Others",children:[{id:"name_types",name:"Name",children:[{id:"full",name:"Full Name",type:"/nameperson/full"},{id:"first",name:"First Name",type:"/nameperson/first"},{id:"last",name:"Last Name",type:"/nameperson/last"},{id:"middle",name:"Middle Name",type:"/nameperson/middle"},{id:"prefix",name:"Title (Mr/Mrs/Ms)",type:"/nameperson/prefix"},{id:"suffix",name:"Suffix (Jr/Sr/II)",type:"/nameperson/suffix"}]},{id:"dob",name:"Date of birth",children:[{id:"age",name:"Age",type:"/birthdate/age"},{id:"month",name:"Birth month",type:"/birthdate/birthmonth"},{id:"day",name:"Birth day",type:"/birthdate/birthday"},{id:"year",name:"Birth year",type:"/birthdate/birthyear"},{id:"mmddyyyy1",name:"Birth Date (MM-DD-YYYY)",type:"/birthdate/MM-DD-YYYY"},{id:"mmddyyyy2",name:"Birth Date (MM/DD/YYYY)",type:"/birthdate/MM/DD/YYYY"},{id:"ddmmyyyy1",name:"Birth Date (DD-MM-YYYY)",type:"/birthdate/DD-MM-YYYY"},{id:"ddmmyyyy2",name:"Birth Date (DD/MM/YYYY)",type:"/birthdate/DD/MM/YYYY"}]},{id:"gender",name:"Gender",type:"/person/gender"},{id:"website",name:"Website Url",type:"/website"},{id:"company",name:"Company Name",type:"/company/name"},{id:"position",name:"Company Position",type:"/company/position"},{id:"ssn",name:"SSN #",type:"/socialSecurityNumber"},{id:"dl",name:"Driver License",type:"/driverLicense"},{id:"ff",name:"Frequent Flier #",type:"/loyalty/flier"},{id:"lc",name:"Loyalty Card #",type:"/loyalty/card"},{id:"captcha",name:"Captcha",type:"/captcha"},{id:"otp",name:"One Time Password",type:"/auth/otp"},{id:"hint",name:"Password Hint",type:"/auth/hint"},{id:"question",name:"Security Question",type:"/auth/question"},{id:"answer",name:"Security Answer",type:"/auth/answer"},{id:"comment",name:"Comment",type:"/comment"},{id:"subject",name:"Subject",type:"/subject"},{id:"message",name:"Message",type:"/message"}]},change:{id:"change",name:"Fill Change Password Form",forForm:"changePassword",children:[{id:"email",name:"Email",type:"/contact/email"},{id:"password1",name:"Old Password",type:"/passwordold"},{id:"password2",name:"New Password",children:[{id:"password1",name:"Password",type:"/password"},{id:"password2",name:"Limited special chars (.-_)",label:"Password with .-_",type:"/password/differentSpecialChars"},{id:"password3",name:"No special characters",label:"Password without special",type:"/password/noSpecialChars"},{id:"password4",name:"No numbers",label:"Password without numbers",type:"/password/noNumbers"}]}]},address_mapping:{id:"correct",name:"Correct an Address Auto-fill Problem",children:[{id:"default",name:"Default Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3"},{id:"city",name:"City",type:"/contact/city"},{id:"state",name:"State",type:"/contact/state"},{id:"statecode",name:"State Code",type:"/contact/state/code"},{id:"country",name:"Country",type:"/contact/country"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode"},{id:"zip+",name:"Zip+4",type:"/contact/zip4"}]},{id:"billing",name:"Billing Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/billing"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/billing"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/billing"},{id:"city",name:"City",type:"/contact/city/billing"},{id:"state",name:"State",type:"/contact/state/billing"},{id:"statecode",name:"State Code",type:"/contact/state/code/billing"},{id:"country",name:"Country",type:"/contact/country/billing"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/billing"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/billing"}]},{id:"shipping",name:"Shipping Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/shipping"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/shipping"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/shipping"},{id:"city",name:"City",type:"/contact/city/shipping"},{id:"state",name:"State",type:"/contact/state/shipping"},{id:"statecode",name:"State Code",type:"/contact/state/code/shipping"},{id:"country",name:"Country",type:"/contact/country/shipping"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/shipping"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/shipping"}]},{id:"business",name:"Business Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/business"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/business"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/business"},{id:"city",name:"City",type:"/contact/city/business"},{id:"state",name:"State",type:"/contact/state/business"},{id:"statecode",name:"State Code",type:"/contact/state/code/business"},{id:"country",name:"Country",type:"/contact/country/business"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/business"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/business"}]},{id:"home",name:"Home Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/home"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/home"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/home"},{id:"city",name:"City",type:"/contact/city/home"},{id:"state",name:"State",type:"/contact/state/home"},{id:"statecode",name:"State Code",type:"/contact/state/code/home"},{id:"country",name:"Country",type:"/contact/country/home"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/home"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/home"}]}]},phone_mapping:{id:"correct",name:"Correct an Phone Auto-fill Problem",children:[{id:"default",name:"Default Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension"}]},{id:"home",name:"Home Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/home"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/home"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/home"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/home"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/home"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/home"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/home"}]},{id:"work",name:"Work Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/work"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/work"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/work"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/work"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/work"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/work"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/work"}]},{id:"mobile",name:"Mobile Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/mobile"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/mobile"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/mobile"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/mobile"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/mobile"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/mobile"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/mobile"}]},{id:"fax",name:"Fax Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/fax"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/fax"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/fax"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/fax"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/fax"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/fax"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/fax"}]}]}},_=null,f=/postal|city|state|contact\/country/i,g=/(nameperson\/(first|last|middle|full))|social|company|dob|driver|website/i,b=/financial/i,y=/phone/i,v=/\/email|\/friendly|\/password/i,w=t.BaseModel.extend({initialize:function(){}}),k=t.BaseCollection.extend({model:w,initialize:function(){},loadMenu:function(e,t,n,l,d){var c={},h=-1;if(e.match(/.*\.[0-9]+$/)){var _=e.lastIndexOf(".");h=parseInt(e.substr(_+1)),e=e.substring(0,_)}if(null!=t&&(c["{data_type}"]=a(t)),null!=n&&(c["{form_type}"]=i(n)),null!=t&&null!=n){var v=m(t,n);null!=v&&(c["{group}"]=v)}c["{app}"]="site",d.email&&(c["{email}"]=d.email);var w=e.indexOf(".more")!=-1,k=[],E=e.replace(".more","").split(/\./),A=p,N={},T={children:[]};N.root=T,null!=t&&(t.match(f)?n="addressForm":t.match(y)?n="phoneForm":t.match(b)?n="checkoutForm":t.match(g)&&(n="identityForm")),A[n]||(n="otherForm");for(var D=A[n],M=0;M<D.length;M++){var I=D[M];if("more"!=I||!w){"dont_show"==I&&(I="dont_show_extension");var C=A[I];if((!C.forType||null!=t&&t.match(new RegExp(C.forType,"i")))&&(T.children.push(C),!w&&"more"==I))break}}for(var M=0;M<E.length;M++){var B=E[M];if(N[B])N=N[B];else if(N.children)for(var S=N.children,x=0;x<S.length;x++){var P=S[x];P=u(A,P),P.id==B&&(N=P)}}if(N.children)for(var S=N.children,M=0;M<S.length;M++){var P=S[M];P=u(A,P);var z=P.id;if(P.when){var O=P.when;if(O.indexOf("has_data")!=-1&&0==d[O.replace("_has_data","")].length)continue}if("mask_card"!=P.action)if(P.entities){var H=r(e,c,P,z,d[P.entities]);k=k.concat(H),d.CurrentEntity=null}else if(P.entity){var F,R=d[P.entity];h==-1?F=d.CurrentEntity:(F=R.at(h),d.CurrentEntity=F);var q=s(e,c,P,z,F,h);null!=q&&k.push(q)}else{var q=o(e,l,c,P,z);null!=q&&k.push(q)}}for(var M=0;M<k.length;M++)k[M].set("idx",M);this.reset(k)}});return t.MappingMenu=w,t.MappingMenuCollection=k,{MappingMenu:w,MappingMenuCollection:k}}),ABINE_DNTME.define("abine/models/shieldedCard",["models","documentcloud/underscore","abine/eventLogger"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedCard",interestedBroadcasts:/broadcast:billinginfo:updated/i,generateDisposable:function(){return new e.DisposableCard({shielded_card_id:this.get("id")})},getName:function(){return this.get("first_name")+" "+this.get("last_name")},getExpiry:function(){return parseInt(this.get("month"))+" / "+parseInt(this.get("year"))},getFirstName:function(){return this.get("first_name").toUpperCase()},getLastName:function(){return this.get("last_name").toUpperCase()},getLastFour:function(){return this.get("last_four")},getProtectedNumber:function(){if(!this.get("number"))return"---";var e=this.get("number")+"";return e.substr(0,e.length-4).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){if(!this.get("number"))return"---";var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)}}),n=e.BaseCollection.extend({model:t,getPrimaryCardName:function(){return this.models.length>0?this.models[0].getFirstName+" "+this.models[0].getLastName():""},getPrimaryCardLastFour:function(){return this.models.length>0?this.models[0].getLastFour():""},getPrimaryCardExpiry:function(){return this.models.length>0?this.models[0].get:""}});return e.ShieldedCard=t,e.ShieldedCardCollection=n,{ShieldedCard:t,ShieldedCardCollection:n}}),ABINE_DNTME.define("abine/models/shieldedEmail",["models"],function(e){var t=e.BaseModel.extend({}),n=e.BaseModel.extend({storageEntity:"shieldedEmail",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({altEmails:{collection:i}})},generateDisposable:function(t,n){return new e.DisposableEmail({targetGuid:this.get("guid"),label:t,source:n})},getAddress:function(){return this.get("email")},isValidated:function(){return 1==this.get("active")},resendValidationEmail:function(e){this.sync("update",this,{eventName:"update:shieldedEmail:resendValidationEmail:"+this.get("id"),success:function(t){e(t)},error:function(t){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/shieldedEmail]#[resendValidationEmail]# error event in model.sync eventName: update:shieldedEmail:resendValidationEmail:id"),e(t)}})}}),a=e.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:register:success/i}),i=e.BaseCollection.extend({model:t});return e.ShieldedEmail=n,e.ShieldedEmailCollection=a,{ShieldedEmail:n,ShieldedEmailCollection:a}}),ABINE_DNTME.define("abine/models/shieldedPhone",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedPhone",generateDisposable:function(){return new e.DisposablePhone({shielded_phone_id:this.get("id")})},hasNumber:function(){return!(!this.has("number")||""==this.get("number"))},registerNumber:function(e){this.sync("create",this,{eventName:"create:shieldedPhone",success:e.success,error:e.error})},verifySecret:function(e){this.sync("update",this,{eventName:"update:shieldedPhone:secret",success:e.success,error:e.error})},getCountryCode:function(){return this.get("country_code")||"1"},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){return this.isNorthAmericaFormat()?"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():this.isEuropeanFormat()?"0"+this.get("number"):this.get("number")},getFullPrettyNumber:function(){return this.isNorthAmericaFormat()?"+"+this.getCountryCode()+" ("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():"+"+this.getCountryCode()+" "+this.get("number")},isNorthAmericaFormat:function(){return"1"==this.getCountryCode()},isEuropeanFormat:function(){var e=this.getCountryCode()[0];return"3"==e||"4"==e},isTextAllowed:function(){return this.getCountryCode()in{1:1,44:1}},isValidated:function(){return"true"==this.get("is_validated")}}),n=e.BaseCollection.extend({model:t});return e.ShieldedPhone=t,e.ShieldedPhoneCollection=n,{ShieldedPhone:t,ShieldedPhoneCollection:n}}),ABINE_DNTME.define("abine/models/tabData",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,a){var i=t.BaseModel.extend({storageEntity:"pageTracker",hasSuggested:function(){return!0}}),r=t.BaseCollection.extend({model:i,getBlocked:function(){for(var e=0,t=0;t<this.length;t++)1==this.at(t).get("blocked")&&e++;return e},getAllowed:function(){for(var e=0,t=0;t<this.length;t++)1!=this.at(t).get("blocked")&&e++;return e}}),s=t.BaseModel.extend({storageEntity:"blacklistOrPreference"}),o=t.BaseModel.extend({storageEntity:"customTabData"}),l=t.BaseCollection.extend({model:o,isFeedbackShown:function(){for(var e=0;e<this.length;e++)if("feedbackShown"==this.at(e).get("name"))return this.at(e).get("value");return!1},changedFeature:function(){for(var e=0;e<this.length;e++)if("changedFeature"==this.at(e).get("name")){var t=this.at(e).get("value");if(""==t)break;var n=this.changedFeatureOffStatus(),i=n?"off":"on";return a.getText("mm_dntme_toggled_"+t+"_"+i)}return null},changedFeatureOffStatus:function(){for(var e=0;e<this.length;e++)if("changedFeatureOffStatus"==this.at(e).get("name"))return this.at(e).get("value");return null},setCustomTabData:function(e,t){for(var n=null,a=0;a<this.length;a++)this.at(a).get("name")==e&&(n=this.at(a));n||(n=new o,this.add(n)),n.save({name:e,value:t})}}),d=t.BaseModel.extend({storageEntity:"tabData",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({trackers:{collection:r},custom:{collection:l}}),this.hasOne({blacklist:{model:t.Blacklist},dntStats:{model:t.DntStats}})},hasFiveOrMoreTrackers:function(){return this.trackers.length>=5},hasMobileAppAndDropboxEnabled:function(){return this.get("hasMobileApp")&&this.get("dropboxEnabled")&&this.get("entitledToSync")},fetchTrackers:function(e){e=e||{},e.eventName="read:"+this.storageEntity+":trackers",this.fetch(e)}});return t.TabData=d,t.CustomTabData=o,t.BlacklistOrPreference=s,{TabData:d}}),ABINE_DNTME.define("abine/models/pageData",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"pageData"});return t.PageData=n,{PageData:n}}),ABINE_DNTME.define("abine/models/address",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"address",getFormattedText:function(){var e=[this.get("address1"),this.get("address2"),this.get("city"),this.get("state"),this.get("zip")].join(",");return e=e.replace(/(\s*,\s*)+/g,", ")},toFillData:function(){return this.toJSON()}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()}});return e.Address=t,e.AddressCollection=n,{Address:t,AddressCollection:n}}),ABINE_DNTME.define("abine/models/account",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"account",getFormattedText:function(){var e=[];return this.get("email")&&e.push("Email: "+this.get("email")),this.get("username")&&e.push("Username: "+this.get("username")),this.get("password")&&e.push("Password: "+this.get("password")),e.join("\n")},getAddress:function(){var e=this.get("label");if(e&&e.length>0&&e!=this.get("domain"))return e;var t=this.get("email");if(t&&t.length>0)return t;var n=this.get("username");if(n&&n.length>0)return n;var a=this.get("password");return a&&a.length>0?"- Only Password -":"- Not set -"},toFillData:function(){return{label:this.getAddress(),email:this.get("email"),username:this.get("username"),password:this.get("password")}}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:account:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})},fetchLoginsByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:logins:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})},fetchAccountsByPassword:function(e,t){this.sync("read",this,{eventName:"read:accounts:password:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})}});return e.Account=t,e.AccountCollection=n,{Account:t,AccountCollection:n}}),ABINE_DNTME.define("abine/models/identity",["models","documentcloud/underscore","abine/intl","abine/assets"],function(e){var t=e.BaseModel.extend({storageEntity:"identity",getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},toFillData:function(){var e=this.toJSON();return e.full_name=(this.get("first_name")+" "+this.get("last_name")).replace(/^[\s]+|[\s]+$/g,"").replace(/[\s]+$/g," "),e.email&&e.email.indexOf("@")!=-1&&(e.real_email=e.email),e}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()}});return e.Identity=t,e.IdentityCollection=n,{Identity:t,IdentityCollection:n}}),ABINE_DNTME.define("abine/models/realCard",["models","documentcloud/underscore","abine/intl","abine/assets"],function(e,t,n,a){var i=e.BaseModel.extend({storageEntity:"realCard",getLastFour:function(){return this.get("number").substr(this.get("number").length-4)},getNonDefaultLabel:function(){var e=this.get("label");return e&&e.toLowerCase()==(this.getType()+" "+this.getLastFour()).toLowerCase()?null:e},labelChangeRequired:function(){var e=this.get("label");return!(!e||!(e.length>15||e.toLowerCase()==(this.getType()+" "+this.getLastFour()).toLowerCase()))},getLabelOrLastFour:function(){if(this.getNonDefaultLabel())return n.getText("mm_payment_helper_useCardName",[this.getLabel()]);var e=this.getDisplayType();return e?n.getText("mm_payment_helper_useCardName",[e+"-"+this.getLastFour()]):n.getText("mm_payment_helper_useCardName",["x"+this.getLastFour()])},getCardNumber:function(){return this.get("number")},getSeparatedCardNumber:function(){var e=this.get("number");return 16==e.length?e.substring(0,4)+" "+e.substring(4,8)+" "+e.substring(8,12)+" "+e.substring(12,16):this.get("type")&&this.get("type").match(/amex|american/i)?e.substr(0,4)+" "+e.substr(4,6)+" "+e.substr(10):e},getSeparatedMaskedCardNumber:function(){var e=this.get("number");if(16==e.length)return Array(4).join("**** ")+e.substring(12,16);var t=this.get("type");return t&&t.match(/amex|american/i)?"**** ****** *"+e.substr(-4):Array(e.length-3).join("*")+e.substr(-4)},getMaskedVerification:function(){return Array(this.get("cvc").length+1).join("*")},getMaskedExpiry:function(){return this.getExpiry().replace(/[0-9]/g,"*")},getBrandImage:function(){var e=this.getBrand();return e&&e.match(/asd/)||(e="no_match"),a.assetUrl("/pages/images/blank_cards/"+e+".png")},getTypeImage:function(){var e=this.getType();return e.match(/american_express|diners_club|discover|jcb|laser|maestro|mastercard|visa/)||(e="no_match"),a.assetUrl("/pages/images/credit_cards/"+e+".png")},getAddress:function(){var e=this.get("address");if(!e)return null;var t=[e.address1,e.address2,e.city,e.state,e.zip].join(",");return t=t.replace(/(\s*,\s*)+/g,", ")},getFormattedText:function(){var e=[this.get("first_name")+" "+this.get("last_name"),this.getPrettyNumber(),"Exp: "+this.getExpiry()+" CVC: "+this.getCVC(),this.getAddress()].join("\n");return e=e.replace(/[\n]+/g,"\n")},getAddress1:function(){var e=this.get("address");return e?e.address1.replace(/(\s*,\s*)+/g,", "):null},getAddress2:function(){var e=this.get("address");return e?e.address2.replace(/(\s*,\s*)+/g,", "):null},getCityState:function(){var e=this.get("address");if(!e)return null;var t=[e.city,e.state].join(",");return t=t.replace(/(\s*,\s*)+/g,", ")},getPostal:function(){var e=this.get("address");return e?e.zip.replace(/(\s*,\s*)+/g,", "):null},getType:function(){return this.get("type").toLowerCase()},getDisplayType:function(){var e=this.getType();return e.match(/visa/)?"Visa":e.match(/master/)?"Master":e.match(/amex|american/)?"Amex":e.match(/diner/)?"Diners":e.match(/discover/)?"Discover":e.match(/jcb/)?"Jcb":e.match(/laser/)?"Lazer":e.match(/maestro/)?"Maestro":null},getBrand:function(){return this.get("brand").toLowerCase()},getPrettyNumber:function(){for(var e="",t=0;t<this.get("number").length;t++)e+=this.get("number").charAt(t),t%4==3&&(e+="  ");return e},getCVC:function(){return this.get("cvc")},getExpiry:function(){var e=parseInt(this.get("expiry_month"));return e<10&&(e="0"+e),e+"/"+this.get("expiry_year")},getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getProtectedNumber:function(){var e=this.get("number")+"";return e.substr(0,e.length-12).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)},isRealCard:function(){return"real_card"==this.get("cardType")},isOfferCard:function(){return"offer"==this.get("cardType")},isNewMaskedCard:function(){return"new_masked_card"==this.get("cardType")},isNewRealCard:function(){return"new_real_card"==this.get("cardType")},toFillData:function(){var e=this.toJSON(),t=e.number;return e.last_4=t.substr(t.length-4),16==t.length?(e.first_4=t.substring(0,4),e.second_4=t.substring(4,8),e.third_4=t.substring(8,12)):e.type&&e.type.match(/ame/i)&&(e.amex_4=t.substring(0,4),e.amex_6=t.substring(4,10),e.amex_5=t.substring(10,15)),e.expiry_year&&e.expiry_month&&(e.expiry=e.expiry_month+"/"+e.expiry_year,e.expiry2=e.expiry_month+"/"+e.expiry_year.substring(2)),e.expiry_year&&(e.expiry_year2=e.expiry_year.substring(2)),e.full_name=(e.first_name+" "+e.last_name).replace(/^[\s]+|[\s]+$/g,"").replace(/[\s]+$/g," "),null!=this.get("address")&&(e.address=this.get("address")),e}}),r=e.BaseCollection.extend({model:i,initialize:function(){this.messenger=this.getMessenger()},fetchOfferCardsForDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:realCard:offers:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/realCard]#[fetchAllForDomain]# error event in read:realCard:offers:domain"),t(!0)}})},fetchAllForDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:realCard:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/realCard]#[fetchAllForDomain]# error event in read:realCard:site:domain"),t(!0)}})}});return e.RealCard=i,e.RealCardCollection=r,{RealCard:i,RealCardCollection:r}}),ABINE_DNTME.define("abine/models/globalData",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,a){var i=t.BaseModel.extend({storageEntity:"globalTracker",hasSuggested:function(){return!1}}),r=t.BaseCollection.extend({model:i}),s=t.BaseModel.extend({storageEntity:"globalPreference",getLabel:function(){return a.getText("mm_dntme_"+this.get("name").toLowerCase())},getId:function(){return this.get("name").toLowerCase()},getTooltip:function(){return a.getText("mm_dntme_help_"+this.get("name").toLowerCase())}}),o=t.BaseCollection.extend({model:s}),l=t.BaseModel.extend({storageEntity:"globalFeature",getLabel:function(){var e=this.get("name");switch(e){case"suggestStrongPassword":return a.getText("mm_dntme_accounts_password");case"suggestAddresses":return a.getText("mm_dntme_wallet_address");case"suggestRealCard":return a.getText("mm_dntme_wallet_real_card");case"rememberCards":return a.getText("mm_dntme_wallet_save_card");case"suggestIdentities":return a.getText("mm_dntme_wallet_identity");case"browsing":return a.getText("mm_dntme_tracking_blocker");case"email":return a.getText("mm_dntme_masking_email");case"phone":return a.getText("mm_dntme_masking_phone");case"card":return a.getText("mm_dntme_masking_card");case"search":return a.getText("mm_dntme_masking_search");case"helpMeLogin":return a.getText("mm_dntme_accounts_help_login");case"submitAccount":return a.getText("mm_dntme_accounts_submit_account");case"rememberAccounts":return a.getText("mm_dntme_accounts_save_account");
case"showCheckoutPanelGrowl":return a.getText("mm_dntme_showcheckoutpanelgrowl")}},isBrowsing:function(){return"browsing"==this.get("name")},getTooltip:function(){var e=this.get("value")?"off":"on";return this.isBrowsing()?a.getText("mm_dntme_help_what_will_happen_"+e+"_"+this.get("name").toLowerCase(),"all sites"):a.getText("mm_dntme_help_what_will_happen_"+e+"_"+this.get("name").toLowerCase())}}),d=t.BaseCollection.extend({model:l}),c=t.BaseModel.extend({storageEntity:"globalData",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({trackers:{collection:r},preferences:{collection:o},globalFeatures:{collection:d},blacklist:{collection:t.BlacklistCollection}})}});return t.GlobalData=c,{GlobalData:c}}),ABINE_DNTME.define("abine/models/feedback",["documentcloud/underscore","documentcloud/backbone","models"],function(e,t,n){var a=n.BaseModel.extend({initialize:function(){},getSuccessLeadMsg:function(){return this.attributes.leadMsg},getSuccessMsg:function(){return this.attributes.successMsg},clone:function(){var e=new this.constructor(this);return e.user=this.user,e}});return n.Feedback=a,{Feedback:a}}),ABINE_DNTME.define("abine/models/trackerInfo",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"trackerInfo",initialize:function(){this.messenger=this.getMessenger()}}),a=t.BaseCollection.extend({model:n,fetchAllForDomains:function(e,t){this.sync("read",this,{eventName:"read:trackerInfo:index",payload:{domains:e},success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableEmail:domain:domain")}})}});return t.TrackerInfo=n,t.TrackerInfoCollection=a,{TrackerInfo:n,TrackerInfoCollection:a}}),ABINE_DNTME.define("abine/models/advt",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"advt",initialize:function(){this.messenger=this.getMessenger()}}),a=t.BaseCollection.extend({model:n,fetchAllForQuery:function(e,t,n){this.sync("read",this,{eventName:"read:advt:index",payload:{query:e,url:t},success:function(e){this.reset(e),n()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/advt]#[fetchAllByQuery]# error event in model.sync eventName: read:advt:index")}})}});return t.Advt=n,t.AdvtCollection=a,{Advt:n,AdvtCollection:a}});